// Generated by CoffeeScript 1.2.1-pre
(function() {

  $(document).ready(function() {
    var form_se_connecter, form_sinscrire, formulaire_inscription, formulaire_seconnecter, select_connection, select_pr, submit_next_step;
    form_se_connecter = {
      display: function() {
        return $('#l_se_connecter').fadeIn(1000);
      },
      hide: function() {
        return $('#l_se_connecter').css('display', 'none');
      }
    };
    formulaire_inscription = new FormulaireSinscrire('#form_sinscrire', '#form_sinscrire #b_sign_up');
    formulaire_seconnecter = new FormulaireSeConnecter('#form_se_connecter', '#b_sign_in>a');
    form_sinscrire = {
      init: function() {},
      display: function() {
        return $('#l_sinscrire').fadeIn(1000);
      },
      hide: function() {
        return $('#l_sinscrire').css('display', 'none');
      }
    };
    submit_next_step = {
      init: function() {},
      event: function() {
        $('#b_next_step>a').bind('click', function() {
          console.log('test');
          if ($('input[type=radio]:checked').length > 0) {
            return $('#form_select_pr').submit();
          } else {
            return alert('Veuillez choisir un point relai');
          }
        });
        return $('#form_sinscrire, #form_se_connecter').bind('ajax:success', function(data, response) {
          if ($('#l_areyouinscrit').length > 0) {
            select_connection.hide();
            return submit_next_step.add_submit();
          }
        });
      },
      add_submit: function() {
        if ($('#footer_confirmation>span.next_step').length === 0) {
          $('#footer_confirmation').append('<span class="button next_step" id="b_next_step"><a> Proc√©der paiement</a></span>');
          return submit_next_step.event();
        }
      },
      remove_submit: function() {
        return $('#form_select_pr>.actions').html('');
      }
    };
    select_pr = {
      init: function() {
        select_pr.radio_box_checked();
        return select_pr.event();
      },
      event: function() {
        return $('li .radio').bind('click', function() {
          return select_pr.is_checked(this);
        });
      },
      is_checked: function(element) {
        var one_element_check;
        one_element_check = false;
        $('.products>li .radio').each(function() {
          if ($(this).css('background-position') === '-16px -26px') {
            one_element_check = true;
            if (this === element) {
              return select_pr.decheck(this);
            } else {
              select_pr.decheck(this);
              select_pr.check(element);
              return false;
            }
          }
        });
        if (!one_element_check) return select_pr.check(element);
      },
      check: function(element) {
        var pr_id;
        $(element).css('background-position', '-16px -26px');
        pr_id = (($(element).parent('div').parent('div').parent('div')).attr('id')).replace('pr_', '');
        return $('input[name="point_relai[id]"]').val([pr_id]);
      },
      decheck: function(element) {
        return $(element).css('background-position', '0 -26px');
      },
      radio_box_checked: function() {
        var id_pr;
        if ($('input[type=radio]:checked').length > 0) {
          id_pr = $('input[type=radio]:checked').val();
          return select_connection.check($('#pr_' + id_pr + '>div>.image>.radio'));
        }
      }
    };
    select_connection = {
      init: function() {
        return select_connection.event_();
      },
      event_: function() {
        $('.choice').bind('click', function() {
          return select_connection.is_checked(this);
        });
        return $('#b_next_step').bind('click', function() {
          if ($('input[type=radio]:checked').length > 0) {
            return $('.l_select_pr').submit();
          } else {
            return alert('Veuillez choisir un point relai');
          }
        });
      },
      is_checked: function(element) {
        var one_element_check;
        one_element_check = false;
        $('.choice').each(function() {
          if ($(this).hasClass('is_choose')) {
            one_element_check = true;
            if (this === element) {
              return select_connection.decheck(this);
            } else {
              select_connection.decheck(this);
              select_connection.check(element);
              return false;
            }
          }
        });
        if (!one_element_check) return select_connection.check(element);
      },
      check: function(element) {
        $(element).addClass('is_choose');
        if ($(element).hasClass('yes')) {
          form_sinscrire.hide();
          return form_se_connecter.display();
        } else {
          form_se_connecter.hide();
          return form_sinscrire.display();
        }
      },
      decheck: function(element) {
        $(element).removeClass('is_choose');
        if ($(element).hasClass('yes')) {
          return form_se_connecter.hide();
        } else {
          return form_sinscrire.hide();
        }
      },
      hide: function() {
        return $("#l_areyouinscrit").css('display', 'none');
      }
    };
    select_pr.init();
    select_connection.init();
    return submit_next_step.event();
  });

}).call(this);
