/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function t(t,n,r,i,s,o,u,a,f){function c(e){+e[0]&&(e[0]=l.axis(n+v,r+v,i-2*v,p,d,f.axisxstep||Math.floor((i-2*v)/20),2,f.axisxlabels||null,f.axisxtype||"t",null,t)),+e[1]&&(e[1]=l.axis(n+i-v,r+s-v,s-2*v,g,y,f.axisystep||Math.floor((s-2*v)/20),3,f.axisylabels||null,f.axisytype||"t",null,t)),+e[2]&&(e[2]=l.axis(n+v,r+s-v+A,i-2*v,p,d,f.axisxstep||Math.floor((i-2*v)/20),0,f.axisxlabels||null,f.axisxtype||"t",null,t)),+e[3]&&(e[3]=l.axis(n+v-A,r+s-v,s-2*v,g,y,f.axisystep||Math.floor((s-2*v)/20),1,f.axisylabels||null,f.axisytype||"t",null,t))}var l=this;f=f||{};var h=l.snapEnds(Math.min.apply(Math,o),Math.max.apply(Math,o),o.length-1),p=h.from,d=h.to,v=f.gutter||10,m=l.snapEnds(Math.min.apply(Math,u),Math.max.apply(Math,u),u.length-1),g=m.from,y=m.to,b=Math.max(o.length,u.length,a.length),w=t[f.symbol]||"circle",E=t.set(),S=t.set(),x=f.max||100,T=Math.max.apply(Math,a),N=[],C=Math.sqrt(T/Math.PI)*2/x;for(var k=0;k<b;k++)N[k]=Math.min(Math.sqrt(a[k]/Math.PI)*2/C,x);v=Math.max.apply(Math,N.concat(v));var L=t.set(),A=Math.max.apply(Math,N);if(f.axis){var O=(f.axis+"").split(/[,\s]+/);c.call(l,O);var M=[],_=[];for(var k=0,D=O.length;k<D;k++){var P=O[k].all?O[k].all.getBBox()[["height","width"][k%2]]:0;M[k]=P+v,_[k]=P}v=Math.max.apply(Math,M.concat(v));for(var k=0,D=O.length;k<D;k++)O[k].all&&(O[k].remove(),O[k]=1);c.call(l,O);for(var k=0,D=O.length;k<D;k++)O[k].all&&L.push(O[k].all);E.axis=L}var H=(i-v*2)/(d-p||1),B=(s-v*2)/(y-g||1);for(var k=0,D=u.length;k<D;k++){var j=t.raphael.is(w,"array")?w[k]:w,F=n+v+(o[k]-p)*H,I=r+s-v-(u[k]-g)*B;j&&N[k]&&S.push(t[j](F,I,N[k]).attr({fill:f.heat?e(N[k],A):l.colors[0],"fill-opacity":f.opacity?N[k]/x:1,stroke:"none"}))}var q=t.set();for(var k=0,D=u.length;k<D;k++){var F=n+v+(o[k]-p)*H,I=r+s-v-(u[k]-g)*B;q.push(t.circle(F,I,A).attr(l.shim)),f.href&&f.href[k]&&q[k].attr({href:f.href[k]}),q[k].r=+N[k].toFixed(3),q[k].x=+F.toFixed(3),q[k].y=+I.toFixed(3),q[k].X=o[k],q[k].Y=u[k],q[k].value=a[k]||0,q[k].dot=S[k]}return E.covers=q,E.series=S,E.push(S,L,q),E.hover=function(e,t){return q.mouseover(e).mouseout(t),this},E.click=function(e){return q.click(e),this},E.each=function(e){if(!t.raphael.is(e,"function"))return this;for(var n=q.length;n--;)e.call(q[n]);return this},E.href=function(e){var t;for(var n=q.length;n--;)t=q[n],t.X==e.x&&t.Y==e.y&&t.value==e.value&&t.attr({href:e.href})},E}var e=function(e,t,n,r){return"hsb("+[Math.min((1-e/t)*.4,1),n||.75,r||.75]+")"},n=function(){};n.prototype=Raphael.g,t.prototype=new n,Raphael.fn.dotchart=function(e,n,r,i,s,o,u,a){return new t(this,e,n,r,i,s,o,u,a)}})();