/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function t(t,n,r,i,s,o,u,a,f){function c(e){+e[0]&&(e[0]=l.axis(n+v,r+v,i-2*v,p,d,f.axisxstep||Math.floor((i-2*v)/20),2,f.axisxlabels||null,f.axisxtype||"t",null,t)),+e[1]&&(e[1]=l.axis(n+i-v,r+s-v,s-2*v,g,y,f.axisystep||Math.floor((s-2*v)/20),3,f.axisylabels||null,f.axisytype||"t",null,t)),+e[2]&&(e[2]=l.axis(n+v,r+s-v+O,i-2*v,p,d,f.axisxstep||Math.floor((i-2*v)/20),0,f.axisxlabels||null,f.axisxtype||"t",null,t)),+e[3]&&(e[3]=l.axis(n+v-O,r+s-v,s-2*v,g,y,f.axisystep||Math.floor((s-2*v)/20),1,f.axisylabels||null,f.axisytype||"t",null,t))}var l=this;f=f||{};var h=l.snapEnds(Math.min.apply(Math,o),Math.max.apply(Math,o),o.length-1),p=h.from,d=h.to,v=f.gutter||10,m=l.snapEnds(Math.min.apply(Math,u),Math.max.apply(Math,u),u.length-1),g=m.from,y=m.to,w=Math.max(o.length,u.length,a.length),E=t[f.symbol]||"circle",S=t.set(),x=t.set(),T=f.max||100,N=Math.max.apply(Math,a),C=[],k=Math.sqrt(N/Math.PI)*2/T;for(var L=0;L<w;L++)C[L]=Math.min(Math.sqrt(a[L]/Math.PI)*2/k,T);v=Math.max.apply(Math,C.concat(v));var A=t.set(),O=Math.max.apply(Math,C);if(f.axis){var M=(f.axis+"").split(/[,\s]+/);c.call(l,M);var _=[],D=[];for(var L=0,P=M.length;L<P;L++){var H=M[L].all?M[L].all.getBBox()[["height","width"][L%2]]:0;_[L]=H+v,D[L]=H}v=Math.max.apply(Math,_.concat(v));for(var L=0,P=M.length;L<P;L++)M[L].all&&(M[L].remove(),M[L]=1);c.call(l,M);for(var L=0,P=M.length;L<P;L++)M[L].all&&A.push(M[L].all);S.axis=A}var B=(i-v*2)/(d-p||1),j=(s-v*2)/(y-g||1);for(var L=0,P=u.length;L<P;L++){var F=t.raphael.is(E,"array")?E[L]:E,I=n+v+(o[L]-p)*B,q=r+s-v-(u[L]-g)*j;F&&C[L]&&x.push(t[F](I,q,C[L]).attr({fill:f.heat?e(C[L],O):l.colors[0],"fill-opacity":f.opacity?C[L]/T:1,stroke:"none"}))}var R=t.set();for(var L=0,P=u.length;L<P;L++){var I=n+v+(o[L]-p)*B,q=r+s-v-(u[L]-g)*j;R.push(t.circle(I,q,O).attr(l.shim)),f.href&&f.href[L]&&R[L].attr({href:f.href[L]}),R[L].r=+C[L].toFixed(3),R[L].x=+I.toFixed(3),R[L].y=+q.toFixed(3),R[L].X=o[L],R[L].Y=u[L],R[L].value=a[L]||0,R[L].dot=x[L]}return S.covers=R,S.series=x,S.push(x,A,R),S.hover=function(e,t){return R.mouseover(e).mouseout(t),this},S.click=function(e){return R.click(e),this},S.each=function(e){if(!t.raphael.is(e,"function"))return this;for(var n=R.length;n--;)e.call(R[n]);return this},S.href=function(e){var t;for(var n=R.length;n--;)t=R[n],t.X==e.x&&t.Y==e.y&&t.value==e.value&&t.attr({href:e.href})},S}var e=function(e,t,n,r){return"hsb("+[Math.min((1-e/t)*.4,1),n||.75,r||.75]+")"},n=function(){};n.prototype=Raphael.g,t.prototype=new n,Raphael.fn.dotchart=function(e,n,r,i,s,o,u,f){return new t(this,e,n,r,i,s,o,u,f)}})();