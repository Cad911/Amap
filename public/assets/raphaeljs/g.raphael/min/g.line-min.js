/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function e(e,t){var n=e.length/t,r=0,i=n,s=0,o=[];while(r<e.length)i--,i<0?(s+=e[r]*(1+i),o.push(s/n),s=e[r++]*-i,i+=n):s+=e[r++];return o}function t(e,t,n,r,i,s){var o=(n-e)/2,u=(i-n)/2,a=Math.atan((n-e)/Math.abs(r-t)),f=Math.atan((i-n)/Math.abs(r-s));a=t<r?Math.PI-a:a,f=s<r?Math.PI-f:f;var l=Math.PI/2-(a+f)%(Math.PI*2)/2,c=o*Math.sin(l+a),h=o*Math.cos(l+a),p=u*Math.sin(l+f),d=u*Math.cos(l+f);return{x1:n-c,y1:r+h,x2:n+p,y2:r+d}}function n(n,r,i,s,o,u,f,l){function Q(e){var t=[];for(var a=0,l=u.length;a<l;a++)t=t.concat(u[a]);t.sort();var c=[],p=[];for(a=0,l=t.length;a<l;a++)t[a]!=t[a-1]&&c.push(t[a])&&p.push(r+h+(t[a]-k)*_);t=c,l=t.length;var d=e||n.set();for(a=0;a<l;a++){var v=p[a]-(p[a]-(p[a-1]||r))/2,m=((p[a+1]||r+s)-p[a])/2+(p[a]-(p[a-1]||r))/2,y;e?y={}:d.push(y=n.rect(v-1,i,Math.max(m+1,1),o).attr({stroke:"none",fill:"#000",opacity:0})),y.values=[],y.symbols=n.set(),y.y=[],y.x=p[a],y.axis=t[a];for(var w=0,E=f.length;w<E;w++){c=u[w]||u[0];for(var S=0,x=c.length;S<x;S++)c[S]==t[a]&&(y.values.push(f[w][S]),y.y.push(i+o-h-(f[w][S]-O)*D),y.symbols.push(b.symbols[w][S]))}e&&e.call(y)}!e&&(g=d)}function G(e){var t=e||n.set(),s;for(var a=0,l=f.length;a<l;a++)for(var c=0,p=f[a].length;c<p;c++){var d=r+h+((u[a]||u[0])[c]-k)*_,v=r+h+((u[a]||u[0])[c?c-1:1]-k)*_,m=i+o-h-(f[a][c]-O)*D;e?s={}:t.push(s=n.circle(d,m,Math.abs(v-d)/2).attr({stroke:"none",fill:"#000",opacity:0})),s.x=d,s.y=m,s.value=f[a][c],s.line=b.lines[a],s.shade=b.shades[a],s.symbol=b.symbols[a][c],s.symbols=b.symbols[a],s.axis=(u[a]||u[0])[c],e&&e.call(s)}!e&&(y=t)}var c=this;l=l||{},n.raphael.is(u[0],"array")||(u=[u]),n.raphael.is(f[0],"array")||(f=[f]);var h=l.gutter||10,p=Math.max(u[0].length,f[0].length),v=l.symbol||"",m=l.colors||c.colors,g=null,y=null,b=n.set(),w=[];for(var E=0,S=f.length;E<S;E++)p=Math.max(p,f[E].length);var x=n.set();for(E=0,S=f.length;E<S;E++)l.shade&&x.push(n.path().attr({stroke:"none",fill:m[E],opacity:l.nostroke?1:.3})),f[E].length>s-2*h&&(f[E]=e(f[E],s-2*h),p=s-2*h),u[E]&&u[E].length>s-2*h&&(u[E]=e(u[E],s-2*h));var T=Array.prototype.concat.apply([],u),N=Array.prototype.concat.apply([],f),C=c.snapEnds(Math.min.apply(Math,T),Math.max.apply(Math,T),u[0].length-1),k=C.from,L=C.to,A=c.snapEnds(Math.min.apply(Math,N),Math.max.apply(Math,N),f[0].length-1),O=A.from,M=A.to,_=(s-h*2)/(L-k||1),D=(o-h*2)/(M-O||1),P=n.set();if(l.axis){var H=(l.axis+"").split(/[,\s]+/);+H[0]&&P.push(c.axis(r+h,i+h,s-2*h,k,L,l.axisxstep||Math.floor((s-2*h)/20),2,n)),+H[1]&&P.push(c.axis(r+s-h,i+o-h,o-2*h,O,M,l.axisystep||Math.floor((o-2*h)/20),3,n)),+H[2]&&P.push(c.axis(r+h,i+o-h,s-2*h,k,L,l.axisxstep||Math.floor((s-2*h)/20),0,n)),+H[3]&&P.push(c.axis(r+h,i+o-h,o-2*h,O,M,l.axisystep||Math.floor((o-2*h)/20),1,n))}var B=n.set(),j=n.set(),F;for(E=0,S=f.length;E<S;E++){l.nostroke||B.push(F=n.path().attr({stroke:m[E],"stroke-width":l.width||2,"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":l.dash||""}));var I=Raphael.is(v,"array")?v[E]:v,q=n.set();w=[];for(var R=0,U=f[E].length;R<U;R++){var z=r+h+((u[E]||u[0])[R]-k)*_,W=i+o-h-(f[E][R]-O)*D;(Raphael.is(I,"array")?I[R]:I)&&q.push(n[Raphael.is(I,"array")?I[R]:I](z,W,(l.width||2)*3).attr({fill:m[E],stroke:"none"}));if(l.smooth){if(R&&R!=U-1){var X=r+h+((u[E]||u[0])[R-1]-k)*_,V=i+o-h-(f[E][R-1]-O)*D,$=r+h+((u[E]||u[0])[R+1]-k)*_,J=i+o-h-(f[E][R+1]-O)*D,K=t(X,V,z,W,$,J);w=w.concat([K.x1,K.y1,z,W,K.x2,K.y2])}R||(w=["M",z,W,"C",z,W])}else w=w.concat([R?"L":"M",z,W])}l.smooth&&(w=w.concat([z,W,z,W])),j.push(q),l.shade&&x[E].attr({path:w.concat(["L",z,i+o-h,"L",r+h+((u[E]||u[0])[0]-k)*_,i+o-h,"z"]).join(",")}),!l.nostroke&&F.attr({path:w.join(",")})}return b.push(B,x,j,P,g,y),b.lines=B,b.shades=x,b.symbols=j,b.axis=P,b.hoverColumn=function(e,t){return!g&&Q(),g.mouseover(e).mouseout(t),this},b.clickColumn=function(e){return!g&&Q(),g.click(e),this},b.hrefColumn=function(e){var t=n.raphael.is(arguments[0],"array")?arguments[0]:arguments;if(!(arguments.length-1)&&typeof e=="object")for(var r in e)for(var i=0,s=g.length;i<s;i++)g[i].axis==r&&g[i].attr("href",e[r]);!g&&Q();for(i=0,s=t.length;i<s;i++)g[i]&&g[i].attr("href",t[i]);return this},b.hover=function(e,t){return!y&&G(),y.mouseover(e).mouseout(t),this},b.click=function(e){return!y&&G(),y.click(e),this},b.each=function(e){return G(e),this},b.eachColumn=function(e){return Q(e),this},b}var r=function(){};r.prototype=Raphael.g,n.prototype=new r,Raphael.fn.linechart=function(e,t,r,i,s,o,u){return new n(this,e,t,r,i,s,o,u)}})();