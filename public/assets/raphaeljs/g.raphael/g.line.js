/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function e(e,t){var n=e.length/t,r=0,i=n,s=0,o=[];while(r<e.length)i--,i<0?(s+=e[r]*(1+i),o.push(s/n),s=e[r++]*-i,i+=n):s+=e[r++];return o}function t(e,t,n,r,i,s){var o=(n-e)/2,u=(i-n)/2,a=Math.atan((n-e)/Math.abs(r-t)),f=Math.atan((i-n)/Math.abs(r-s));a=t<r?Math.PI-a:a,f=s<r?Math.PI-f:f;var l=Math.PI/2-(a+f)%(Math.PI*2)/2,c=o*Math.sin(l+a),h=o*Math.cos(l+a),p=u*Math.sin(l+f),d=u*Math.cos(l+f);return{x1:n-c,y1:r+h,x2:n+p,y2:r+d}}function n(n,r,i,s,o,u,a,f){function J(e){var t=[];for(var f=0,l=u.length;f<l;f++)t=t.concat(u[f]);t.sort();var h=[],p=[];for(f=0,l=t.length;f<l;f++)t[f]!=t[f-1]&&h.push(t[f])&&p.push(r+c+(t[f]-N)*O);t=h,l=t.length;var d=e||n.set();for(f=0;f<l;f++){var m=p[f]-(p[f]-(p[f-1]||r))/2,y=((p[f+1]||r+s)-p[f])/2+(p[f]-(p[f-1]||r))/2,b;e?b={}:d.push(b=n.rect(m-1,i,Math.max(y+1,1),o).attr({stroke:"none",fill:"#000",opacity:0})),b.values=[],b.symbols=n.set(),b.y=[],b.x=p[f],b.axis=t[f];for(var w=0,E=a.length;w<E;w++){h=u[w]||u[0];for(var S=0,x=h.length;S<x;S++)h[S]==t[f]&&(b.values.push(a[w][S]),b.y.push(i+o-c-(a[w][S]-L)*M),b.symbols.push(g.symbols[w][S]))}e&&e.call(b)}!e&&(v=d)}function K(e){var t=e||n.set(),s;for(var f=0,l=a.length;f<l;f++)for(var h=0,p=a[f].length;h<p;h++){var d=r+c+((u[f]||u[0])[h]-N)*O,v=r+c+((u[f]||u[0])[h?h-1:1]-N)*O,y=i+o-c-(a[f][h]-L)*M;e?s={}:t.push(s=n.circle(d,y,Math.abs(v-d)/2).attr({stroke:"none",fill:"#000",opacity:0})),s.x=d,s.y=y,s.value=a[f][h],s.line=g.lines[f],s.shade=g.shades[f],s.symbol=g.symbols[f][h],s.symbols=g.symbols[f],s.axis=(u[f]||u[0])[h],e&&e.call(s)}!e&&(m=t)}var l=this;f=f||{},n.raphael.is(u[0],"array")||(u=[u]),n.raphael.is(a[0],"array")||(a=[a]);var c=f.gutter||10,h=Math.max(u[0].length,a[0].length),p=f.symbol||"",d=f.colors||l.colors,v=null,m=null,g=n.set(),y=[];for(var b=0,w=a.length;b<w;b++)h=Math.max(h,a[b].length);var E=n.set();for(b=0,w=a.length;b<w;b++)f.shade&&E.push(n.path().attr({stroke:"none",fill:d[b],opacity:f.nostroke?1:.3})),a[b].length>s-2*c&&(a[b]=e(a[b],s-2*c),h=s-2*c),u[b]&&u[b].length>s-2*c&&(u[b]=e(u[b],s-2*c));var S=Array.prototype.concat.apply([],u),x=Array.prototype.concat.apply([],a),T=l.snapEnds(Math.min.apply(Math,S),Math.max.apply(Math,S),u[0].length-1),N=T.from,C=T.to,k=l.snapEnds(Math.min.apply(Math,x),Math.max.apply(Math,x),a[0].length-1),L=k.from,A=k.to,O=(s-c*2)/(C-N||1),M=(o-c*2)/(A-L||1),_=n.set();if(f.axis){var D=(f.axis+"").split(/[,\s]+/);+D[0]&&_.push(l.axis(r+c,i+c,s-2*c,N,C,f.axisxstep||Math.floor((s-2*c)/20),2,n)),+D[1]&&_.push(l.axis(r+s-c,i+o-c,o-2*c,L,A,f.axisystep||Math.floor((o-2*c)/20),3,n)),+D[2]&&_.push(l.axis(r+c,i+o-c,s-2*c,N,C,f.axisxstep||Math.floor((s-2*c)/20),0,n)),+D[3]&&_.push(l.axis(r+c,i+o-c,o-2*c,L,A,f.axisystep||Math.floor((o-2*c)/20),1,n))}var P=n.set(),H=n.set(),B;for(b=0,w=a.length;b<w;b++){f.nostroke||P.push(B=n.path().attr({stroke:d[b],"stroke-width":f.width||2,"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":f.dash||""}));var j=Raphael.is(p,"array")?p[b]:p,F=n.set();y=[];for(var I=0,q=a[b].length;I<q;I++){var R=r+c+((u[b]||u[0])[I]-N)*O,U=i+o-c-(a[b][I]-L)*M;(Raphael.is(j,"array")?j[I]:j)&&F.push(n[Raphael.is(j,"array")?j[I]:j](R,U,(f.width||2)*3).attr({fill:d[b],stroke:"none"}));if(f.smooth){if(I&&I!=q-1){var z=r+c+((u[b]||u[0])[I-1]-N)*O,W=i+o-c-(a[b][I-1]-L)*M,X=r+c+((u[b]||u[0])[I+1]-N)*O,V=i+o-c-(a[b][I+1]-L)*M,$=t(z,W,R,U,X,V);y=y.concat([$.x1,$.y1,R,U,$.x2,$.y2])}I||(y=["M",R,U,"C",R,U])}else y=y.concat([I?"L":"M",R,U])}f.smooth&&(y=y.concat([R,U,R,U])),H.push(F),f.shade&&E[b].attr({path:y.concat(["L",R,i+o-c,"L",r+c+((u[b]||u[0])[0]-N)*O,i+o-c,"z"]).join(",")}),!f.nostroke&&B.attr({path:y.join(",")})}return g.push(P,E,H,_,v,m),g.lines=P,g.shades=E,g.symbols=H,g.axis=_,g.hoverColumn=function(e,t){return!v&&J(),v.mouseover(e).mouseout(t),this},g.clickColumn=function(e){return!v&&J(),v.click(e),this},g.hrefColumn=function(e){var t=n.raphael.is(arguments[0],"array")?arguments[0]:arguments;if(!(arguments.length-1)&&typeof e=="object")for(var r in e)for(var i=0,s=v.length;i<s;i++)v[i].axis==r&&v[i].attr("href",e[r]);!v&&J();for(i=0,s=t.length;i<s;i++)v[i]&&v[i].attr("href",t[i]);return this},g.hover=function(e,t){return!m&&K(),m.mouseover(e).mouseout(t),this},g.click=function(e){return!m&&K(),m.click(e),this},g.each=function(e){return K(e),this},g.eachColumn=function(e){return J(e),this},g}var r=function(){};r.prototype=Raphael.g,n.prototype=new r,Raphael.fn.linechart=function(e,t,r,i,s,o,u){return new n(this,e,t,r,i,s,o,u)}})();