/**
 * Class that takes care that the value of the composer and the textarea is always in sync
 */
(function(e){var t=400;e.views.Synchronizer=Base.extend({constructor:function(e,t,n){this.editor=e,this.textarea=t,this.composer=n,this._observe()},fromComposerToTextarea:function(t){this.textarea.setValue(e.lang.string(this.composer.getValue()).trim(),t)},fromTextareaToComposer:function(e){var t=this.textarea.getValue();t?this.composer.setValue(t,e):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(e){this.editor.currentView.name==="textarea"?this.fromTextareaToComposer(e):this.fromComposerToTextarea(e)},_observe:function(){var n,r=this,i=this.textarea.element.form,s=function(){n=setInterval(function(){r.fromComposerToTextarea()},t)},o=function(){clearInterval(n),n=null};s(),i&&(e.dom.observe(i,"submit",function(){r.sync(!0)}),e.dom.observe(i,"reset",function(){setTimeout(function(){r.fromTextareaToComposer()},0)})),this.editor.observe("change_view",function(e){e==="composer"&&!n?(r.fromTextareaToComposer(!0),s()):e==="textarea"&&(r.fromComposerToTextarea(!0),o())}),this.editor.observe("destroy:composer",o)}})})(wysihtml5);