(function(){$(document).ready(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d;return l={listing:function(){return $(".historique,.add,.help,.stats,.edit,.delete").tool_tip(1e3)},listing_one_tooltip:function(e){return e.tool_tip(1e3)}},l.listing(),p={id_photo:"",init:function(){return $(".deleted_p_c").on("click",function(){var e,t,n,r,i;p.id_photo="#"+$(this).attr("id"),$(this).hasClass("photo_stock")&&(t="photo_stock"),$(this).hasClass("photo_user")&&(t="photo_user"),$(this).hasClass("photo_panier")&&(t="photo_panier"),e=$(this).attr("id"),r=parseInt(e.replace(t+"_","")),$(this).hasClass("photo_stock")&&(i=$(this).parents(".left_area").next().children(".informations_card").children(".id_stock").val(),p.supp_photo_stock(r,i)),$(this).hasClass("photo_user")&&p.supp_photo_user(r);if($(this).hasClass("photo_panier"))return n=$(this).parents(".left_area").next().children(".informations_card").children(".id_panier").val(),p.supp_photo_basket(r,n)})},init_one_event:function(e){return $(e).on("click",function(){var e,t,n;return e=$(this).attr("id"),console.log(e),t=parseInt(e.replace("photo_stock_","")),n=$(this).parents(".left_area").next().children(".informations_card").children(".id_stock").val(),p.supp(t,n)})},supp_photo_basket:function(e,t){var n;return n=new XMLHttpRequest,n.open("DELETE","/administration/users/"+$(".user_id").val()+"/paniers/"+t+"/delete_image/"+e),n.send(null),n.onreadystatechange=function(){if(n.readyState===n.DONE)return p.animation_supp(e)}},supp_photo_user:function(e){var t;return t=new XMLHttpRequest,t.open("DELETE","/administration/users/"+$(".user_id").val()+"/delete_image/"+e),t.send(null),t.onreadystatechange=function(){if(t.readyState===t.DONE)return p.animation_supp(e)}},supp_photo_stock:function(e,t){var n;return n=new XMLHttpRequest,n.open("DELETE","/administration/users/"+$(".user_id").val()+"/stocks/"+t+"/delete_image/"+e),n.send(null),n.onreadystatechange=function(){if(n.readyState===n.DONE)return p.animation_supp()}},animation_supp:function(){var e,t,n;$(p.id_photo).hasClass("photo_stock")&&(e=$(p.id_photo).parents(".picture").parents("div.left_area"),$(p.id_photo).parents(".picture").remove(),p.regenerate_class(e)),$(p.id_photo).hasClass("photo_user")&&$(p.id_photo).parents(".is_small.has_corners_shadow").parents("li").remove();if($(p.id_photo).hasClass("photo_panier"))return console.log("le test before"),console.log(p.id_photo),e=$(p.id_photo).parents(".picture").parents("div.left_area"),n=e.parents(".card").parents("div.card_stack").children(".packaging").children(".footer").children("ul.main-informations").children("li.number_image").children("span.number"),t=parseInt(n.text()),t-=1,n.text(t),$(p.id_photo).parents(".picture").remove(),p.regenerate_class(e)},regenerate_class:function(e){var t;return t=0,console.log(e),$(e).children(".picture").each(function(){var e;return e="",$(this).hasClass("is-editing")&&(e="is-editing "),$(this).removeClass($(this).attr("class")),t%2===0?e+="picture first_cloumn":e+="picture",$(this).addClass(e),t++})}},($(".photo_stock").length>0||$(".photo_user").length>0||$(".photo_panier").length>0)&&p.init(),n={card:"",init:function(){return $(".add.button.image.add_user_image").on("click",function(){var e;return e=$(this).attr("id").replace("user_id_",""),n.card=$(this).parents("li").parents("ul"),console.log(n.card),n.generate_form(e)})},init_one_element:function(e){return $(e).on("click",function(){var e;return e=$(this).attr("id").replace("user_id_",""),n.card=$(this).parents("li").parents("ul"),n.generate_form(e)})},generate_form:function(e){var t,r,i,s,o,u,a,f,l,c;return window.light_box_information.html_content(""),u=$(document.createElement("form")),u.addClass("form-horizontal"),r={type_element:"input",label:{text:"Nouvelle photo"},input:{value:"",name:"photo_user[image]","class":"",id:"photo_user_image",other_attributes:[["type","file"]]}},s=window.global_functions.standard_input(r),i={type_element:"radio",label:{text:"Photo par defaut"},input:{value:[[1,"Oui"],[0,"Non"]],name:"photo_user[first_image]","class":"photo_user_first_image",id:"photo_user_first_image_1",other_attributes:[["type","radio"]]}},o=window.global_functions.standard_input(i),l=$(document.createElement("span")),l.addClass("button"),t=$(document.createElement("a")),t.addClass("test"),t.text("Ajouter"),l.append(t),c=window.light_box_information.create_annuler(),u.append(s),u.append(o),window.light_box_information.html_footer(c),window.light_box_information.append_footer(l),window.light_box_information.header_html_content(""),window.light_box_information.append_content(u),window.light_box_information.show(),a=$(s).find("input"),f=$(o).find("input.photo_user_first_image"),l.on("click",function(){return n.upload_form(a,f,e)})},upload_form:function(e,t,r){var i,s,o,u,a;return i={},a=new XMLHttpRequest,a.open("POST","/administration/users/"+r+"/add_image"),o=new FormData,u=$(e).attr("name"),o.append($(t).attr("name"),$(t).filter(":checked").val()),console.log(e),s=e[0],console.log(e),console.log(s),o.append(u,s.files[0]),a.send(o),a.onreadystatechange=function(){if(a.readyState===a.DONE)return window.light_box_information.hide(),console.log(a.responseText),i=JSON.parse(a.responseText),n.create_photo(i.photo_user)}},create_photo:function(e){var t,r,i,s,o,u;s=$(document.createElement("li")),t=$(document.createElement("div")),t.addClass("is_small has_corners_shadow"),i=$(document.createElement("img")),i.attr("src",e.image.is_small.url),u=$(document.createElement("span")),u.addClass("deleted_p_c"),u.attr("id","photo_user_"+e.id),p.init_one_event(u),t.append(u),t.append(i),s.append(t),console.log(s),$(n.card).children("li").last().before(s);if(e.first_image===1)return o=$(n.card).children("li").last().prev().children("div"),r=$(n.card).parents(".pictures").children("div.has_corners_shadow.is_medium"),setTimeout(n.animation_first_image,200,r,o,e)},animation_first_image:function(e,t,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g;return d=$(e).position(),v=$(t).position(),s=$(t).attr("class"),g=parseInt($(t).css("width")),a=parseInt($(t).css("height")),l=parseInt($(t).css("margin-left")),f=parseInt($(t).css("margin-bottom")),p=parseInt($(t).css("padding-top")),i=$(e).attr("class"),m=parseInt($(e).css("width")),u=parseInt($(e).css("height")),c=parseInt($(e).css("margin-top")),h=parseInt($(e).css("padding-top")),d.top+=c,console.log(v),d.top+=4,d.left-=3,o=$(document.createElement("div")),o.addClass(s),console.log(m),$(t).css("position","absolute"),$(t).css("top",v.top),$(t).css("left",v.left),$(t).css("z-index","10000"),$(t).after(o),console.log(r),$(t).children("img").attr("src",r.image.is_medium.url),$(t).animate({top:d.top+"px",left:d.left+"px",width:m+"px",height:u+"px",border:"1px solid #DCDCDC"},{duration:2e3,complete:function(){return $(this).removeClass($(this).attr("class")),$(this).addClass(i),$(this).css("position","relative"),$(this).css("top","0px"),$(this).css("left","0px"),$(e).before(this),$(this).remove,$(e).css("position","absolute"),$(e).removeClass("has_corners_shadow"),$(e).css("margin-top","Opx"),$(e).css("padding","Opx"),$(e).css("margin-left",l+"px"),$(e).css("margin-bottom",f+"px"),$(e).css("z-index","10000"),$(e).animate({top:v.top+"px",left:v.left+"px",width:g+"px",height:a+"px",padding:p+"px"},{duration:2e3,complete:function(){return $(this).removeClass($(this).attr("class")),$(this).addClass(s),$(this).css("position","relative"),$(this).css("top","0px"),$(this).css("left","0px"),console.log("test div wait"),console.log(o),o.remove(),$(n.card).children("li").last().prev().append(this),$(this).remove}})}})}},$(".add_user_image").length>0&&n.init(),t={card:"",init:function(){return $(".add.button.image.add_stock_image").on("click",function(){var e;return e=$(this).attr("id").replace("stock_id_",""),t.card=$(this).parents("div").parents("li.card"),t.generate_form(e)})},init_one_element:function(e){return $(e).on("click",function(){var e;return e=$(this).attr("id").replace("stock_id_",""),t.card=$(this).parents("div").parents("li.card"),t.generate_form(e)})},generate_form:function(e){var n,r,i,s,o,u,a,f,l,c;return window.light_box_information.html_content(""),u=$(document.createElement("form")),u.addClass("form-horizontal"),r={type_element:"input",label:{text:"Nouvelle photo"},input:{value:"",name:"photo_stock[image]","class":"",id:"photo_stock_image",other_attributes:[["type","file"]]}},s=window.global_functions.standard_input(r),i={type_element:"radio",label:{text:"Photo par defaut"},input:{value:[[1,"Oui"],[0,"Non"]],name:"photo_stock[first_image]","class":"photo_stock_first_image",id:"photo_stock_first_image_1",other_attributes:[["type","radio"]]}},o=window.global_functions.standard_input(i),l=$(document.createElement("span")),l.addClass("button"),n=$(document.createElement("a")),n.addClass("test"),n.text("Ajouter"),l.append(n),c=window.light_box_information.create_annuler(),u.append(s),u.append(o),window.light_box_information.html_footer(c),window.light_box_information.append_footer(l),window.light_box_information.header_html_content(""),window.light_box_information.append_content(u),window.light_box_information.show(),a=$(s).find("input"),f=$(o).find("input.photo_stock_first_image"),l.on("click",function(){return t.upload_form(a,f,e)})},upload_form:function(e,n,r){var i,s,o,u,a;return i={},a=new XMLHttpRequest,a.open("POST","/administration/users/"+$(".user_id").val()+"/stocks/"+r+"/add_image"),o=new FormData,u=$(e).attr("name"),o.append($(n).attr("name"),$(n).filter(":checked").val()),console.log(e),s=e[0],console.log(e),console.log(s),o.append(u,s.files[0]),a.send(o),a.onreadystatechange=function(){if(a.readyState===a.DONE)return window.light_box_information.hide(),console.log(a.responseText),i=JSON.parse(a.responseText),t.create_photo(i.photo_stock)}},create_photo:function(e){var n,r,i,s,o,u;console.log(e),r=$(document.createElement("div")),s=$(t.card).children(".left_area").children(".picture").length,n="",s%2===0?n="picture first_cloumn":n="picture",r.addClass(n),i=$(document.createElement("img")),i.attr("src",e.image.is_small.url),u=$(document.createElement("span")),u.addClass("deleted_p_c"),u.attr("id","photo_stock_"+e.id),p.init_one_event(u),r.append(u),r.append(i),$(t.card).children(".left_area").children(".picture").length>0?$(t.card).children(".left_area").children(".picture").last().after(r):$(t.card).children(".left_area").children(".is_small.has_corners_shadow").after(r);if(e.first_image===1)return o=$(t.card).children(".left_area").children("div").last(),setTimeout(t.animation_first_image,200,$(t.card).children(".left_area").children(".is_small.has_corners_shadow"),o)},animation_first_image:function(e,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;return h=$(e).position(),p=$(n).position(),r=$(n).attr("class"),v=parseInt($(n).css("width")),o=parseInt($(n).css("height")),a=parseInt($(n).css("margin-left")),u=parseInt($(n).css("margin-bottom")),c=parseInt($(n).css("padding-top")),d=parseInt($(e).css("width")),s=parseInt($(e).css("height")),f=parseInt($(e).css("margin-top")),l=parseInt($(e).css("padding-top")),h.top+=f,console.log(p),$(n).hasClass("first_cloumn")?(h.top+=4,h.left+=3):(h.top+=4,h.left-=3),i=$(document.createElement("div")),i.addClass(r),$(n).css("position","absolute"),$(n).css("top",p.top),$(n).css("left",p.left),$(n).css("z-index","10000"),$(n).after(i),$(n).animate({top:h.top+"px",left:h.left+"px",width:d+"px",height:s+"px",border:"1px solid #DCDCDC"},{duration:2e3,complete:function(){return $(this).removeClass($(this).attr("class")),$(this).addClass("is_small has_corners_shadow"),$(this).css("position","relative"),$(this).css("top","0px"),$(this).css("left","0px"),$(e).before(this),$(this).remove,$(e).css("position","absolute"),$(e).removeClass("has_corners_shadow"),$(e).css("margin-top","Opx"),$(e).css("padding","Opx"),$(e).css("margin-left",a+"px"),$(e).css("margin-bottom",u+"px"),$(e).css("z-index","10000"),$(e).css("border","3px solid #FFFFFF"),$(e).animate({top:p.top+"px",left:p.left+"px",width:v+"px",height:o+"px",padding:c+"px"},{duration:2e3,complete:function(){return $(this).removeClass($(this).attr("class")),$(this).addClass(r),$(this).css("position","relative"),$(this).css("top","0px"),$(this).css("left","0px"),console.log(i),i.remove(),$(t.card).children(".left_area").children("span").last().before(this),$(this).remove}})}})}},$(".cards").length>0&&t.init(),e={card:"",init:function(){return $(".add.button.image.add_stock_image").on("click",function(){var t;return t=$(this).attr("id").replace("panier_id_",""),e.card=$(this).parents("div").parents("div.card"),e.generate_form(t)})},init_one_element:function(t){return $(t).on("click",function(){var t;return t=$(this).attr("id").replace("panier_id_",""),e.card=$(this).parents("div").parents("div.card"),e.generate_form(t)})},generate_form:function(t){var n,r,i,s,o,u,a,f,l,c;return window.light_box_information.html_content(""),u=$(document.createElement("form")),u.addClass("form-horizontal"),r={type_element:"input",label:{text:"Nouvelle photo"},input:{value:"",name:"photo_panier[image]","class":"",id:"photo_panier_image",other_attributes:[["type","file"]]}},s=window.global_functions.standard_input(r),i={type_element:"radio",label:{text:"Photo par defaut"},input:{value:[[1,"Oui"],[0,"Non"]],name:"photo_panier[first_image]","class":"photo_panier_first_image",id:"photo_panier_first_image_1",other_attributes:[["type","radio"]]}},o=window.global_functions.standard_input(i),l=$(document.createElement("span")),l.addClass("button"),n=$(document.createElement("a")),n.addClass("test"),n.text("Ajouter"),l.append(n),c=window.light_box_information.create_annuler(),u.append(s),u.append(o),window.light_box_information.html_footer(c),window.light_box_information.append_footer(l),window.light_box_information.header_html_content(""),window.light_box_information.append_content(u),window.light_box_information.show(),a=$(s).find("input"),f=$(o).find("input.photo_panier_first_image"),l.on("click",function(){return e.upload_form(a,f,t)})},upload_form:function(t,n,r){var i,s,o,u,a;return i={},a=new XMLHttpRequest,a.open("POST","/administration/users/"+$(".user_id").val()+"/paniers/"+r+"/add_image"),o=new FormData,u=$(t).attr("name"),o.append($(n).attr("name"),$(n).filter(":checked").val()),console.log(t),s=t[0],console.log(t),console.log(s),o.append(u,s.files[0]),a.send(o),a.onreadystatechange=function(){if(a.readyState===a.DONE)return window.light_box_information.hide(),console.log(a.responseText),i=JSON.parse(a.responseText),e.create_photo(i.photo_panier)}},create_photo:function(t){var n,r,i,s,o,u,a;console.log(t),r=$(document.createElement("div")),s=$(e.card).children(".left_area").children(".picture").length,n="",s%2===0?n="picture first_cloumn":n="picture",r.addClass(n),i=$(document.createElement("img")),i.attr("src",t.image.is_small.url),a=$(document.createElement("span")),a.addClass("deleted_p_c"),a.attr("id","photo_panier_"+t.id),p.init_one_event(a),r.append(a),r.append(i),$(e.card).children(".left_area").children(".picture").length>0?$(e.card).children(".left_area").children(".picture").last().after(r):$(e.card).children(".left_area").children(".is_small.has_corners_shadow").after(r),u=parseInt(e.card.parents("div.card_stack").children(".packaging").children(".footer").children("ul.main-informations").children("li.number_image").children("span.number").text()),u+=1,e.card.parents("div.card_stack").children(".packaging").children(".footer").children("ul.main-informations").children("li.number_image").children("span.number").text(u);if(t.first_image===1)return o=$(e.card).children(".left_area").children("div").last(),$(e.card),setTimeout(e.animation_first_image,200,$(e.card).children(".left_area").children(".is_small.has_corners_shadow"),o)},animation_first_image:function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;return h=$(t).position(),p=$(n).position(),r=$(n).attr("class"),v=parseInt($(n).css("width")),o=parseInt($(n).css("height")),a=parseInt($(n).css("margin-left")),u=parseInt($(n).css("margin-bottom")),c=parseInt($(n).css("padding-top")),d=parseInt($(t).css("width")),s=parseInt($(t).css("height")),f=parseInt($(t).css("margin-top")),l=parseInt($(t).css("padding-top")),h.top+=f,console.log(p),$(n).hasClass("first_cloumn")?(h.top+=4,h.left+=3):(h.top+=4,h.left-=3),i=$(document.createElement("div")),i.addClass(r),$(n).css("position","absolute"),$(n).css("top",p.top),$(n).css("left",p.left),$(n).css("z-index","10000"),$(n).after(i),$(n).animate({top:h.top+"px",left:h.left+"px",width:d+"px",height:s+"px",border:"1px solid #DCDCDC"},{duration:2e3,complete:function(){return console.log(t),$(this).removeClass($(this).attr("class")),$(this).addClass("is_small has_corners_shadow"),$(this).css("position","relative"),$(this).css("top","0px"),$(this).css("left","0px"),$(t).before(this),$(this).remove,$(t).css("position","absolute"),$(t).removeClass("has_corners_shadow"),$(t).css("margin-top","Opx"),$(t).css("padding","Opx"),$(t).css("margin-left",a+"px"),$(t).css("margin-bottom",u+"px"),$(t).css("z-index","10000"),$(t).css("border","3px solid #FFFFFF"),$(t).animate({top:p.top+"px",left:p.left+"px",width:v+"px",height:o+"px",padding:c+"px"},{duration:2e3,complete:function(){return $(this).removeClass($(this).attr("class")),$(this).addClass(r),$(this).css("position","relative"),$(this).css("top","0px"),$(this).css("left","0px"),console.log(i),i.remove(),$(e.card).children(".left_area").children("span").last().before(this),$(this).remove}})}})}},$(".card_stack").length>0&&e.init(),i={actual_step:1,init:function(){return i.form_new_basket(),i.event(),i.info_panier_autorise($("#panier_panier_autorise_id").val())},re_init_form:function(){return i.actual_step=1,$(".etape_1").css("display","block"),$(".etape_3").css("display","none"),$(".title_1").css("display","block"),$(".title_3").css("display","none")},info_panier_autorise:function(e){var t;return t=$(".user_id").val(),$.ajax("/administration/users/"+t+"/panier_autorises/"+e,{type:"GET",async:!1,format:"json",success:function(e){return console.log(e.panier_autorise.titre),$("#panier_titre").val(e.panier_autorise.titre),$("#panier_description").val(e.panier_autorise.description),!0}}),!0},upload_form:function(){var t,n,s;return t={},s=new XMLHttpRequest,s.open("POST","/administration/users/"+$(".user_id").val()+"/paniers"),n=new FormData,$("#new_panier input, #new_panier textarea, #new_panier select").each(function(){var e,r;r=$(this).attr("name");if(t[r]===void 0&&$(this).attr("type")!=="button"&&$(this).attr("type")!=="file")return t[r]=$(this).val(),n.append(r,$(this).val());if($(this).attr("type")==="file")return e=document.querySelector("#"+$(this).attr("id")),n.append(r,e.files[0])}),s.send(n),s.onreadystatechange=function(){var t,n;if(s.readyState===s.DONE)return i.re_init_form(),window.lightbox_new_basket.hide(),console.log(s.responseText),t=s.responseText,n=$($(t)[0]),n.css({opacity:0,top:"-250px"}),f.one_edit_button(n.find(".buttons_card>.edit")),l.listing_one_tooltip(n.find(".buttons_card>.edit")),l.listing_one_tooltip(n.find(".buttons_card>.delete")),r.init_one_card(n),a.init_one_card(n),$(".card_stack").length>0?$($(".card_stack")[0]).before(n):$(".helper").after(n),i.anim_for_decli_and_product($($(".card_stack")[0])),h.event_one_element(n.find(".buttons_card li.delete")),e.init_one_element(n.find(".add.button.image")),o.init_one_card(n),n.animate({opacity:1,top:"0px"},500)}},anim_for_decli_and_product:function(e){var t,n,r;return n=e.children(".packaging").children(".header").children(".buttons_card").children("li.edit.button"),r=$(""),t=$(""),console.log(t),n.trigger("mouseover"),setTimeout(function(){return n.trigger("mouseout"),n.trigger("click"),setTimeout(function(){return r=e.children(".packaging").children(".footer").children(".main-informations").children("li.product_number"),t=e.children(".packaging").children(".footer").children(".details"),r.tool_tip(200),t.tool_tip(200),r.trigger("mouseover"),t.trigger("mouseover"),r.toggleClass("is-editing-over"),t.toggleClass("is-editing-over"),console.log(t),setTimeout(function(){return r.removeClass("is-editing-over"),t.removeClass("is-editing-over"),r.trigger("mouseout"),t.trigger("mouseout")},3e3)},2e3)},2e3)},event:function(){return $("li.add.button").on("click",function(){return window.lightbox_new_basket.show()}),$(".next_step").on("click",function(){if(!i["error_step_"+s.actual_step]())return i.next_step()}),$(".previous_step").on("click",function(){return i.previous_step()}),$("#panier_panier_autorise_id").on("change",function(){return i.info_panier_autorise($(this).val())})},form_new_basket:function(){return window.lightbox_new_basket=new Lightbox(".lightbox_new_basket",".lightbox_form_new_basket")},verif_one_input:function(e){var t;return t=!1,$(e).val()===""?($(e).parents(".control-group").addClass("error"),t=!0):$(e).parents(".control-group").removeClass("error"),t},error_step_1:function(){var e;return e=!1,$(".etape_1 input, .etape_1 textarea").each(function(){if(i.verif_one_input(this))return e=!0}),e&&window.message_information.message_error(".title_3","erreur","Certain champ sont vides",2e3),e},error_step_2:function(){var e;return e=!1,$(".etape_2 input, .etape_2 textarea").each(function(){if(i.verif_one_input(this))return e=!0}),e&&window.message_information.message_error(".title_3","erreur","Certain champ sont vides",2e3),e},error_step_3:function(){var e;return e=!1,$(".etape_3 input,  .etape_3 textarea").each(function(){if(i.verif_one_input(this))return e=!0}),e&&window.message_information.message_error(".title_3","erreur","Certain champ sont vides",2e3),i.stock_is_depassed()&&(window.message_information.message_error(".title_3","erreur","Quantite en ligne excede celle du stock",2e3),e=!0),e},next_step:function(){var e;return i.actual_step===1?i.upload_form():($(".etape_"+i.actual_step).slideUp(500),$(".title_"+i.actual_step).css("display","none"),i.actual_step+=1,$(".etape_"+i.actual_step).slideDown(500),$(".title_"+i.actual_step).css("display","block"),e=$(".navigation>li>.current").parents("li").next().children("span"),$(".navigation>li>.current").removeClass("current"),console.log(e),e.addClass("current"))},previous_step:function(){var e;return $(".etape_"+i.actual_step).slideUp(500),$(".title_"+i.actual_step).css("display","none"),i.actual_step-=1,$(".etape_"+i.actual_step).slideDown(500),$(".title_"+i.actual_step).css("display","block"),e=$(".navigation>li>.current").parents("li").prev().children("span"),$(".navigation>li>.current").removeClass("current"),console.log(e),e.addClass("current")}},$(".h1_listing_panier").length>0&&i.init(),s={previous_id:"",exist_deja:!1,actual_step:1,init:function(){return s.init_select_stock(),s.form_new_stock(),s.event()},re_init_form:function(){return s.actual_step=1,$(".etape_1").css("display","block"),$(".etape_3").css("display","none"),$(".title_1").css("display","block"),$(".title_3").css("display","none")},init_select_stock:function(){var e;if(s.produit_deja_enstock($("#stock_produit_autorise_id").val())){e=!1,$("#stock_produit_autorise_id option").each(function(){var t;t=$(this).attr("value");if(!s.produit_deja_enstock(t))return e=!0,$("#stock_produit_autorise_id").val(t),s.info_produit_autorise(t)});if(!e)return alert("Tous les produits autorisé sont en stock")}},upload_form:function(){var e,n,r;return e={},r=new XMLHttpRequest,r.open("POST","/administration/users/"+$(".user_id").val()+"/stocks"),n=new FormData,$("#new_stock input, #new_stock textarea, #new_stock select").each(function(){var t,r;r=$(this).attr("name");if(e[r]===void 0&&$(this).attr("type")!=="button"&&$(this).attr("type")!=="file")return e[r]=$(this).val(),n.append(r,$(this).val());if($(this).attr("type")==="file")return t=document.querySelector("#"+$(this).attr("id")),n.append(r,t.files[0])}),r.send(n),r.onreadystatechange=function(){var e,n;if(r.readyState===r.DONE)return s.re_init_form(),window.lightbox_new_stock.hide(),console.log(r.responseText),e=r.responseText,n=$($(e)[0]),n.css({opacity:0,top:"-250px"}),$("ul.cards").prepend(n),d.event_one_element(n.find(".buttons_card li.delete")),t.init_one_element(n.find(".add.button.image")),f.one_edit_button(n.find(".buttons_card>.edit")),u.init_one_card(n),n.animate({opacity:1,top:"0px"},500)},console.log(e)},event:function(){return $(".buttons>li.add").on("click",function(){return window.lightbox_new_stock.show()}),$("#new_stock").bind("ajax:complete",function(e,t){var n,r;return s.re_init_form(),window.lightbox_new_stock.hide(),n=t.responseText,r=$($(n)[0]),r.css({opacity:0,top:"-250px"}),$("ul.cards").prepend(r),d.event_one_element(r.find(".buttons_card li.delete")),r.animate({opacity:1,top:"0px"},500)}),$(".next_step").on("click",function(){if(!s["error_step_"+s.actual_step]())return s.next_step()}),$(".previous_step").on("click",function(){return s.previous_step()}),$(".formulaire_add input,.formulaire_add textarea").on("change",function(){return s.verif_one_input(this)}),$("#produit_vente_libre_quantite").on("change",function(){if(s.stock_is_depassed())return window.message_information.message_error(".title_3","erreur","Quantite en ligne excede celle du stock",2e3)}),$("#produit_vente_libre_nombre_pack").on("change",function(){if(s.stock_is_depassed())return window.message_information.message_error(".title_3","erreur","Quantite en ligne excede celle du stock",2e3)}),$("#stock_produit_autorise_id").on("click",function(){return s.previous_id=$(this).val()}),$("#stock_produit_autorise_id").on("change",function(){return s.produit_deja_enstock($(this).val())?(alert("Deja dans le stock"),$(this).val(s.previous_id)):s.info_produit_autorise($(this).val())})},info_produit_autorise:function(e){var t;return t=$(".user_id").val(),$.ajax("/administration/users/"+t+"/produit_autorises/"+e,{type:"GET",async:!1,format:"json",success:function(e){return $("#stock_titre").val(e.produit_autorise.titre),$("#stock_description").val(e.produit_autorise.description),!0}}),!0},produit_deja_enstock:function(e){var t;return t=$(".user_id").val(),$.ajax("/administration/users/"+t+"/exist_stock/"+e,{type:"GET",async:!1,format:"json",success:function(e){return s.exist_deja=e,!0}}),s.exist_deja},form_new_stock:function(){return window.lightbox_new_stock=new Lightbox(".lightbox_new_stock",".lightbox_form_new_stock")},stock_is_depassed:function(){var e,t,n,r;return $("#produit_vente_libre_quantite").val()===""||$("#produit_vente_libre_nombre_pack").val()===""?!1:(t=parseInt($("#produit_vente_libre_quantite").val()),e=parseInt($("#produit_vente_libre_nombre_pack").val()),r=parseInt($("#stock_quantite").val()),n=r-e*t,n>=0?!1:!0)},verif_one_input:function(e){var t;return t=!1,$(e).val()===""?($(e).parents(".control-group").addClass("error"),t=!0):$(e).parents(".control-group").removeClass("error"),t},error_step_1:function(){var e;return e=!1,$(".etape_1 input, .etape_1 textarea").each(function(){if(s.verif_one_input(this))return e=!0}),e&&window.message_information.message_error(".title_3","erreur","Certain champ sont vides",2e3),e},error_step_2:function(){var e;return e=!1,$(".etape_2 input, .etape_2 textarea").each(function(){if(s.verif_one_input(this))return e=!0}),e&&window.message_information.message_error(".title_3","erreur","Certain champ sont vides",2e3),e},error_step_3:function(){var e;return e=!1,$(".etape_3 input,  .etape_3 textarea").each(function(){if(s.verif_one_input(this))return e=!0}),e&&window.message_information.message_error(".title_3","erreur","Certain champ sont vides",2e3),s.stock_is_depassed()&&(window.message_information.message_error(".title_3","erreur","Quantite en ligne excede celle du stock",2e3),e=!0),e},next_step:function(){var e;return s.actual_step===3?s.upload_form():($(".etape_"+s.actual_step).slideUp(500),$(".title_"+s.actual_step).css("display","none"),s.actual_step+=1,$(".etape_"+s.actual_step).slideDown(500),$(".title_"+s.actual_step).css("display","block"),e=$(".navigation>li>.current").parents("li").next().children("span"),$(".navigation>li>.current").removeClass("current"),console.log(e),e.addClass("current"))},previous_step:function(){var e;return $(".etape_"+s.actual_step).slideUp(500),$(".title_"+s.actual_step).css("display","none"),s.actual_step-=1,$(".etape_"+s.actual_step).slideDown(500),$(".title_"+s.actual_step).css("display","block"),e=$(".navigation>li>.current").parents("li").prev().children("span"),$(".navigation>li>.current").removeClass("current"),console.log(e),e.addClass("current")}},console.log($(".cards")),$("ul.cards").length>0&&s.init(),d={init:function(){return $(".buttons_card li.delete").on("click",function(){var e,t,n;return e=$(this).attr("id").replace("stock_id_",""),n=$(".user_id").val(),t=this,d.have_confirmation(n,e,t)})},"delete":function(e,t,n){return $.ajax({type:"DELETE",url:"/administration/users/"+e+"/stocks/"+t,format:"json",complete:function(e){var t;return t=$(n).parents("li.card"),t.removeClass("in"),t.css("top","0px"),t.animate({opacity:0,top:"-270px"},{duration:500,complete:function(){return $(this).remove()}})}})},have_confirmation:function(e,t,n){var r,i,s;return window.light_box_information.html_content("<p> Etes vous sur ? </p>"),window.light_box_information.title_header("Confirmation"),s=window.light_box_information.create_annuler(),window.light_box_information.html_footer(s),i=$(document.createElement("span")),i.addClass("button"),r=$(document.createElement("a")),r.text("Oui"),i.append(r),window.light_box_information.append_footer(i),window.light_box_information.show(),i.on("click",function(){return window.light_box_information.hide(),d["delete"](e,t,n)})},event_one_element:function(e){return $(e).on("click",function(){var e,t,n;return e=$(this).attr("id").replace("stock_id_",""),n=$(".user_id").val(),t=this,t=this,d.have_confirmation(n,e,t)})}},$("ul.cards").length>0&&d.init(),h={init:function(){var e;return e=this,$(".buttons_card li.delete").on("click",function(){var t,n;return t=$(this).attr("id").replace("panier_id_",""),n=$(".user_id").val(),e.have_confirmation(n,t,this)})},"delete":function(e,t,n){return $.ajax({type:"DELETE",url:"/administration/users/"+e+"/paniers/"+t,format:"json",complete:function(e){var t;return t=$(n).parents("div.card_stack"),t.removeClass("in"),t.css("top","0px"),t.animate({opacity:0,top:"-270px"},{duration:500,complete:function(){return $(this).remove()}})}})},have_confirmation:function(e,t,n){var r,i,s,o;return o=this,window.light_box_information.html_content("<p> Etes vous sur ? </p>"),window.light_box_information.title_header("Confirmation"),s=window.light_box_information.create_annuler(),window.light_box_information.html_footer(s),i=$(document.createElement("span")),i.addClass("button"),r=$(document.createElement("a")),r.text("Oui"),i.append(r),window.light_box_information.append_footer(i),window.light_box_information.show(),i.on("click",function(){return window.light_box_information.hide(),o["delete"](e,t,n)})},event_one_element:function(e){var t;return t=this,$(e).on("click",function(){var e,t;return e=$(this).attr("id").replace("panier_id_",""),t=$(".user_id").val(),h.have_confirmation(t,e,this)})}},$(".h1_listing_panier").length>0&&h.init(),f={init:function(){return f.edit_button(),f.help_button(),f.event_close(),f.stats_button()},heigth_help_div:"0px",event_close:function(){return $(".helper>.close").on("click",function(){return f.close_help(".buttons>li.help")})},stats_button:function(){if($(".buttons>li.stats").length>0)return $(".buttons>li.stats").on("click",function(){return $(this).hasClass("button_active")?($(this).removeClass("button_active"),window.statisitques.hide(),window.statisitques.clear_stats()):($(this).addClass("button_active"),window.statisitques.show(),window.statisitques.init())})},help_button:function(){if($(".buttons>li.help").length>0)return f.heigth_help_div=$(".helper").css("height"),$(".buttons>li.help").on("click",function(){return $(this).hasClass("button_active")?f.close_help(this):f.show_help(this)})},close_help:function(e){return $(e).removeClass("button_active"),$(".helper").animate({opacity:0},{duration:500,complete:function(){return $(this).slideUp(500,function(){return $(this).addClass("helper_close")})}})},show_help:function(e){return $(e).addClass("button_active"),$(".helper").removeClass("helper_close"),$(".helper").slideDown(500,function(){return $(this).animate({opacity:1},{duration:500})})},one_edit_button:function(e){$(".buttons>li.edit").length>0&&$(".buttons>li.edit").on("click",function(){return $(this).hasClass("button_active")?($(this).removeClass("button_active"),f.remove_editing_class()):($(this).addClass("button_active"),f.add_editing_class())});if($(".buttons_card").length>0)return $(e).on("click",function(){if($(this).hasClass("button_active")){$(this).removeClass("button_active"),$(".cards").length>0&&f.remove_editing_class
($(this).parents("li.card"));if($(".card_stack").length>0)return f.remove_editing_class($(this).parents("div.card_stack"))}else{$(this).addClass("button_active"),$(".cards").length>0&&f.add_editing_class($(this).parents("li.card"));if($(".card_stack").length>0)return f.add_editing_class($(this).parents("div.card_stack"))}})},edit_button:function(){$(".buttons>li.edit").length>0&&$(".buttons>li.edit").on("click",function(){return $(this).hasClass("button_active")?($(this).removeClass("button_active"),f.remove_editing_class()):($(this).addClass("button_active"),f.add_editing_class())});if($(".buttons_card").length>0)return $(".buttons_card>.edit").on("click",function(){if($(this).hasClass("button_active")){$(this).removeClass("button_active"),$(".cards").length>0&&f.remove_editing_class($(this).parents("li.card"));if($(".card_stack").length>0)return f.remove_editing_class($(this).parents("div.card_stack"))}else{$(this).addClass("button_active"),$(".cards").length>0&&f.add_editing_class($(this).parents("li.card"));if($(".card_stack").length>0)return f.add_editing_class($(this).parents("div.card_stack"))}})},remove_editing_class:function(e){e==null&&(e="body"),$(".user_profile").length>0&&($(".user_profile>.content>p").removeClass("is-editing"),$(".user_profile>.pictures>div").removeClass("is-editing")),$(".cards").length>0&&($(e).children(".right_area").children(".header").children(".title").removeClass("is-editing"),$(e).children(".right_area").children(".body").children(".description").removeClass("is-editing"),$(e).children(".right_area").children(".footer").children("ul").children("li").removeClass("is-editing"),$(e).children(".left_area").children(".has_corners_shadow").removeClass("is-editing"),$(e).children(".left_area").children(".picture").removeClass("is-editing"));if($(".card_stack").length>0)return $(e).children(".packaging").children(".header").children("span").children(".title").removeClass("is-editing"),$(e).children(".packaging").children(".body").children("span").children(".description").removeClass("is-editing"),$(e).children(".packaging").children(".footer").children("ul").removeClass("is-editing"),$(e).children(".packaging").children(".footer").children("ul.details").removeClass("is-editing"),$(e).children(".packaging").children(".footer").children("ul.main-informations").children("li").removeClass("is-editing"),$(e).children(".three").children(".left_area").children(".picture").removeClass("is-editing")},add_editing_class:function(e){e==null&&(e="body"),$(".user_profile").length>0&&($(".user_profile>.content>p").addClass("is-editing"),$(".user_profile>.pictures>ul>li>div.is_small").addClass("is-editing")),$(".cards").length>0&&(console.log($(e).children(".rigth_area")),$(e).children(".right_area").children(".header").children(".title").addClass("is-editing"),$(e).children(".right_area").children(".body").children(".description").addClass("is-editing"),$(e).children(".right_area").children(".footer").children("ul").children("li").addClass("is-editing"),$(e).children(".left_area").children(".has_corners_shadow").addClass("is-editing"),$(e).children(".left_area").children(".picture").addClass("is-editing"));if($(".card_stack").length>0)return $(e).children(".packaging").children(".header").children("span").children(".title").addClass("is-editing"),$(e).children(".packaging").children(".body").children("span").children(".description").addClass("is-editing"),$(e).children(".packaging").children(".footer").children("ul.details").addClass("is-editing"),$(e).children(".packaging").children(".footer").children("ul.main-informations").children("li.product_number").addClass("is-editing"),$(e).children(".three").children(".left_area").children(".picture").addClass("is-editing")}},f.init(),o={init:function(){return $("div.card_stack>.packaging h2.title").form_plugin({champ:"titre",titre:"Le titre",element:{type:"input"},button:{"class":"update_titre",text_update:"Modifier le titre"},url_get_infos:["user","panier"]}),$("div.card_stack>.packaging p.description").form_plugin({champ:"description",titre:"La description",element:{type:"textarea"},button:{"class":"update_description",text_update:"Modifier le description"},url_get_infos:["user","panier"]})},init_one_card:function(e){return $(e).children(".packaging").find("h2.title").form_plugin({champ:"titre",titre:"Le titre",element:{type:"input"},button:{"class":"update_titre",text_update:"Modifier le titre"},url_get_infos:["user","panier"]}),$(e).children(".packaging").find("p.description").form_plugin({champ:"description",titre:"La description",element:{type:"textarea"},button:{"class":"update_description",text_update:"Modifier le description"},url_get_infos:["user","panier"]})}},o.init(),r={panier_id:0,actual_ul_details:$(""),div_list:$(""),div_form:$(""),div_sous_content:$(""),nombre_declinaison_actuel:0,init:function(){return $("div.card_stack>.packaging ul.details").on("click",function(){if($(this).hasClass("is-editing"))return r.actual_ul_details=this,r.generate_box(),r.add_select(),r.panier_id=$(this).parents("div.footer").prevAll("div.informations_card").children(".id_panier").val(),r.get_panier()})},init_one_card:function(e){return $(e).children(".packaging").find("ul.details").on("click",function(){if($(this).hasClass("is-editing"))return r.actual_ul_details=this,r.generate_box(),r.add_select(),r.panier_id=$(this).parents("div.footer").prevAll("div.informations_card").children(".id_panier").val(),r.get_panier()})},get_panier:function(){var e,t;return e={},t=new XMLHttpRequest,t.open("GET","/administration/users/"+$(".user_id").val()+"/paniers/"+r.panier_id),t.setRequestHeader("Accept","application/json"),t.send(null),t.onreadystatechange=function(){var n,i,s,o;if(t.readyState===t.DONE){e=JSON.parse(t.responseText),console.log(e),i=e.panier.nb_pack_total,o=e.declinaison_panier;for(n in o)s=o[n],r.div_list.append(r.create_fiche_declinaison(s));return r.nombre_declinaison_actuel=i,$(".header-list>p   ").text(i+" paniers en ligne")}}},li_detail:function(e){var t,n,r,i,s,o,u;r=$(document.createElement("li")),r.addClass("detail"),s=$(document.createElement("span")),s.addClass("label"),s.text(e.label),e.value.element==="span"&&(n=$(document.createElement("span")),n.addClass("number"),n.text(e.value.value));if(e.value.element==="ul"){n=$(document.createElement("ul")),n.addClass("number"),u=e.value.value;for(t in u)o=u[t],i=$(document.createElement("li")),o===e.value.check&&i.addClass("check"),i.text(o),n.append(i)}return r.append(s),r.append(n),r},create_fiche_declinaison:function(e){var t,n,i,s,o,u,a,f;return i=$(document.createElement("div")),i.addClass("raw"),f=$(document.createElement("ul")),f.addClass("details"),u=r.li_detail({label:"Max",value:{element:"span",value:e.nb_pack}}),o=r.li_detail({label:"Format",value:{element:"ul",value:[2,4,6],check:parseInt(e.nombre_personne)}}),s=r.li_detail({label:"Duree",value:{element:"ul",value:[3,6,9],check:parseInt(e.duree)}}),a=r.li_detail({label:"Prix",value:{element:"span",value:e.prix_panier_ht}}),f.append(u),f.append(o),f.append(s),f.append(a),n=$(document.createElement("div")),n.addClass("close_square declinaison_panier_"+e.id),n.on("click",function(){return r.supp_declinaison(e,i)}),t=$(document.createElement("div")),t.addClass("clear"),i.append(f),i.append(n),i.append(t),i},generate_box:function(){var e,t;return window.light_box_information.html_content(""),r.div_sous_content=$(document.createElement("div")),r.div_sous_content.addClass("sous_content"),r.div_sous_content.append(r.header_list()),r.div_list=$(document.createElement("div")),r.div_list.addClass("embosed-list basket-details"),r.div_sous_content.append(r.div_list),window.light_box_information.append_content(r.div_sous_content),window.light_box_information.title_header("Les declinaisons"),t=window.light_box_information.create_annuler(),window.light_box_information.html_footer(t),e=$(document.createElement("div")),e.addClass("clear"),r.div_sous_content.append(e),window.light_box_information.show()},header_list:function(){var e,t,n,i,s,o;return n=$(document.createElement("div")),n.addClass("header-list"),i=$(document.createElement("p")),i.text("18 déclinaisons"),s=$(document.createElement("span")),s.addClass("button new-declinaision button_declinaion"),e=$(document.createElement("a")),e.text("Nouvelle déclinaison"),s.append(e),e.on("click",function(){return r.animate_for_form(1e3)}),o=$(document.createElement("span")),o.addClass("back-declinaison button_declinaion"),o.text("retour"),o.on("click",function(){return r.animate_for_tab(1e3)}),t=$(document.createElement("div")),t.addClass("clear"),n.append(i),n.append(s),n.append(o),n.append(t),n},animate_for_tab:function(e){return r.div_sous_content.animate({"margin-left":"0px"},e)},animate_for_form:function(e){return r.div_sous_content.animate({"margin-left":"-600px"},e)},add_select:function(){var e,t,n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;n=$(document.createElement("div")),n.addClass("form_add_decli"),n.css("float","right"),n.css("display","block"),b=$(document.createElement("p")),c=$(document.createElement("label")),c.text("Nombre mis en ligne : "),o=$(document.createElement("input")),o.attr("name","declinaison_panier[nb_pack]"),b.append(c),b.append(o),g=$(document.createElement("p")),f=$(document.createElement("label")),f.text("Nombre de personne : "),S=$(document.createElement("select")),S.attr("name","declinaison_panier[nombre_personne]"),v=[2,4,6],i=0;while(v.length>i)p=$(document.createElement("option")),p.val(v[i]),p.text(v[i]),S.append(p),i++;g.append(f),g.append(S),m=$(document.createElement("p")),a=$(document.createElement("label")),a.text("Duree (mois) : "),E=$(document.createElement("select")),E.attr("name","declinaison_panier[duree]"),d=[3,6,9],i=0;while(d.length>i)p=$(document.createElement("option")),p.val(d[i]),p.text(d[i]),E.append(p),i++;return m.append(a),m.append(E),y=$(document.createElement("p")),l=$(document.createElement("label")),l.text("Prix unite ht: "),s=$(document.createElement("input")),s.attr("name","declinaison_panier[prix_panier_ht]"),y.append(l),y.append(s),w=$(document.createElement("p")),h=$(document.createElement("label")),h.text("Prix unite ttc: "),u=$(document.createElement("input")),u.attr("name","declinaison_panier[prix_panier_ttc]"),w.append(h),w.append(u),t=$(document.createElement("div")),t.addClass("clear"),x=$(document.createElement("span")),e=$(document.createElement("a")),e.text("Ajoutez"),x.addClass("button"),e.on("click",function(){var e;return e={nb_pack:o.val(),nombre_personne:S.val(),duree:E.val(),prix_panier_ht:s.val(),prix_panier_ttc:u.val()},r.add_declinaison(e)}),x.append(e),n.append(g),n.append(m),n.append(b),n.append(y),n.append(w),n.append(x),r.div_form=n,r.div_sous_content.prepend(n)},add_declinaison:function(e){var t,n;return n=new XMLHttpRequest,n.open("POST","/administration/users/"+$(".user_id").val()+"/paniers/create_declinaison"),n.setRequestHeader("Accept","application/json"),t=new FormData,t.append("panier[id]",r.panier_id),t.append("declinaison_panier[nb_pack]",e.nb_pack),t.append("declinaison_panier[nombre_personne]",e.nombre_personne),t.append("declinaison_panier[duree]",e.duree),t.append("declinaison_panier[prix_panier_ht]",e.prix_panier_ht),t.append("declinaison_panier[prix_panier_ttc]",e.prix_panier_ttc),n.send(t),n.onreadystatechange=function(){var t;if(n.readyState===n.DONE)return console.log(n.responseText),t=JSON.parse(n.responseText),t.status==="error"?window.message_information.message_error(".lightbox_wrapper .header","erreur",t.error,5e3):(r.nombre_declinaison_actuel+=e.nb_pack,$(".header-list>p   ").text(r.nombre_declinaison_actuel+" declinaisons"),r.animate_for_tab(1e3),r.div_list.append(r.create_fiche_declinaison(t.declinaison_panier)),r.modify_card())}},have_confirmation:function(e,t){var n,i,s,o;return i=new window.Lightbox(".lightbox_confirmation"),i.html_content("<p> Etes vous sur ? </p>"),i.title_header("Confirmation"),o=i.create_annuler(),i.html_footer(o),s=$(document.createElement("span")),s.addClass("button"),n=$(document.createElement("a")),n.text("Oui"),s.append(n),i.append_footer(s),i.show(),s.on("click",function(){return i.hide(),r.supp_declinaison(e,t)})},supp_declinaison:function(e,t){var n;return console.log(e),n=new XMLHttpRequest,n.open("DELETE","/administration/users/"+$(".user_id").val()+"/paniers/supp_declinaison/"+e.id),n.setRequestHeader("Accept","application/json"),n.send(null),n.onreadystatechange=function(){var i;if(n.readyState===n.DONE)return i=JSON.parse(n.responseText),i.status==="error"?window.message_information.message_error(".lightbox_wrapper .header","erreur",i.error,5e3):(r.nombre_declinaison_actuel-=e.nb_pack,$(".header-list>p   ").text(r.nombre_declinaison_actuel+" declinaisons"),t.animate({left:"500px"},{duration:500,complete:function(){return $(this).remove(),r.modify_card()}}))}},modify_card:function(){var e,t;return e={},t=new XMLHttpRequest,t.open("GET","/administration/users/"+$(".user_id").val()+"/paniers/"+r.panier_id),t.setRequestHeader("Accept","application/json"),t.send(null),t.onreadystatechange=function(){var n,i,s,o;if(t.readyState===t.DONE){e=JSON.parse(t.responseText),console.log(e),$(r.actual_ul_details).children(".detail_max").children(".number").text(e.panier.nb_pack_total),$(r.actual_ul_details).children(".detail_format").children(".number").children("li").removeClass("check"),$(r.actual_ul_details).children(".detail_duree").children(".number").children("li").removeClass("check"),s=e.declinaison_panier,o=[];for(n in s)i=s[n],$(r.actual_ul_details).children(".detail_format").children(".number").children("li").each(function(){if(parseInt(i.nombre_personne)===parseInt($(this).text()))return $(this).addClass("check")}),o.push($(r.actual_ul_details).children(".detail_duree").children(".number").children("li").each(function(){if(parseInt(i.duree)===parseInt($(this).text()))return $(this).addClass("check")}));return o}}}},$("div.card_stack").length>0&&r.init(),a={panier_id:"",div_sous_content:$(""),div_list:$(""),ul_listing_produit:$(""),value_id_actual_stock:0,select_stock:$(""),number_product:0,li_number_product:$(""),init:function(){return $("div.card_stack>.packaging ul.main-informations>.product_number").on("click",function(){if($(this).hasClass("is-editing"))return a.panier_id=$(this).parents("div.footer").prevAll("div.informations_card").children(".id_panier").val(),a.number_product=parseInt($(this).children(".number").text()),a.li_number_product=this,a.generate_box(),a.all_product(),a.get_own_stock()})},init_one_card:function(e){return $(e).children(".packaging").find("ul.main-informations").children(".product_number").on("click",function(){if($(this).hasClass("is-editing"))return a.panier_id=$(this).parents("div.footer").prevAll("div.informations_card").children(".id_panier").val(),a.number_product=parseInt($(this).children(".number").text()),a.li_number_product=this,a.generate_box(),a.all_product(),a.get_own_stock()})},generate_box:function(){var e;return window.light_box_information.html_content(""),a.div_sous_content=$(document.createElement("div")),a.div_sous_content.addClass("sous_content"),a.div_sous_content.append(a.header_list()),a.div_list=$(document.createElement("div")),a.div_list.addClass(""),a.div_sous_content.append(a.div_list),window.light_box_information.append_content(a.div_sous_content),window.light_box_information.title_header("titre"),e=window.light_box_information.create_annuler(),window.light_box_information.html_footer(e),window.light_box_information.show()},header_list:function(){var e,t,n,r,i,s;return n=$(document.createElement("div")),n.addClass("header-list"),r=$(document.createElement("p")),r.text(a.number_product+" produits dans le panier"),i=$(document.createElement("span")),i.addClass("button new-declinaision button_declinaion"),e=$(document.createElement("a")),e.text("Ajouter un produit"),i.append(e),e.on("click",function(){return a.animate_for_form(1e3)}),s=$(document.createElement("span")),s.addClass("back-declinaison button_declinaion"),s.text("retour"),s.on("click",function(){return a.animate_for_tab(1e3)}),t=$(document.createElement("div")),t.addClass("clear"),n.append(r),n.append(i),n.append(s),n.append(t),n},animate_for_tab:function(e){return a.div_sous_content.animate({"margin-left":"0px"},e)},animate_for_form:function(e){var t;return t=new XMLHttpRequest,t.open("POST","/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/all_produit_stock_already_in"),t.setRequestHeader("Accept","application/json"),t.send(null),t.onreadystatechange=function(){var n;if(t.readyState===t.DONE)return n=JSON.parse(t.responseText),n.status==="error"?window.message_information.message_error(".lightbox .header","erreur","Tous les produits du stock sont dans le panier",2e3):(a.verif_all_stock(),a.div_sous_content.animate({"margin-left":"-600px"},e))}},all_product:function(){var e;return e=new XMLHttpRequest,e.open("GET","/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/get_all_product"),e.send(null),e.onreadystatechange=function(){var t,n;if(e.readyState===e.DONE)return t=e.responseText,window.light_box_information.title_header("Produits du panier"),a.div_sous_content.append(t),a.ul_listing_produit=a.div_sous_content.find(".other_products").children("ul"),a.div_sous_content.find(".close_square").each(function(){var e,t;return t=$(this).parents(".content").parents("div").parents("li"),e=$(this).attr("id").replace("produit_panier_",""),$(this).on("click",function(){return a.supp_product_basket(e,t)})}),n=$(document.createElement("div")),n.addClass("clear"),a.div_sous_content.append(n),window.light_box_information.show()}},button_add_product:function(){var e;return e=window.global_functions.standard_button({link:{text:"Ajouter un produit",event:[{type:"click",callback:[a.get_own_stock]}]}}),window.light_box_information.append_content(e)},form_add_product:function(e){var t,n,r,i,s,o,u,f;f=[];for(n in e)u=e[n],r={value:u.id,text:u.titre},f.push(r);return s=window.global_functions.standard_input({type_element:"select",label:{text:"Produit"},input:{value:"",options:f,name:"","class":"",id:""}}),a.select_stock=s.find("select"),s.find("select").on("mouseenter",function(){return a.value_id_actual_stock=$(this).val()}),s.find("select").on("change",function(){return a.verif_stock($(this).val(),this)}),o=window.global_functions.standard_input({type_element:"input",label:{text:"Quantite"},input:{value:"",name:"","class":"",id:""}}),t=window.global_functions.standard_button({link:{text:"Ajoutez nouveau produit"}}),t.on("click",function(){return a.add_product({stock_id:s.find("select").val(),quantite:o.find("input").val()})}),i=$(document.createElement("div")),i.addClass("form_add_product"),i.css("float","right"),i.css("display","block"),i.append(s),i.append(o),i.append(t),a.div_sous_content.prepend(i)},verif_all_stock:function(){var e;return e=!1,a.select_stock.find("option").each(function(){var t,n;return $(this).removeAttr("selected"),t=$(this).attr("value"),n=this,$.when($.ajax({type:"POST",url:"/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/produit_stock_already_in",data:{stock_id:t},format:"json",complete:function(e){var t;return t=$.parseJSON(e.responseText),t.status==="error"?!0:!1}})).done(function(t){console.log(t);if(t.status==="OK"&&!e)return e=!0,$(n).attr("selected","selected"),!1})})},verif_stock:function(e,t,n){var r,i,s;return n==null&&(n=!0),s=new XMLHttpRequest,s.open("POST","/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/produit_stock_already_in"),s.setRequestHeader("Accept","application/json"),i=new FormData,i.append("stock_id",e),s.send(i),r=!1,s.onreadystatechange=function(){var e;if(s.readyState===s.DONE)return e=JSON.parse(s.responseText),e.status==="error"?(n&&(window.message_information.message_error(".lightbox_wrapper .header","erreur",e.error,2e3),$(t).val(a.value_id_actual_stock)),r=!0):r=!1},r},get_own_stock:function(){var e;return e=new XMLHttpRequest,e.open("GET","/administration/users/"+$(".user_id").val()+"/stocks/"),e.setRequestHeader("Accept","application/json"),e.send(null),e.onreadystatechange=function(){var t;if(e.readyState===e.DONE){t=JSON.parse(e.responseText);if(t.status==="OK")return a.form_add_product(t.stock)}}},add_product:function(e){var t,n;return n=new XMLHttpRequest,n.open("POST","/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/produit_paniers"),n.setRequestHeader("Accept","application/json"),t=new FormData,t.append("produit_panier[stock_id]",e.stock_id),t.append("produit_panier[quantite]",e.quantite),n.send(t),n.onreadystatechange=function(){var e;if(n.readyState===n.DONE)return e=JSON.parse(n.responseText),e.status==="error"?window.message_information.message_error(".lightbox_wrapper .header","erreur",e.error,5e3):(a.fiche_product(e.produit_panier),a.number_product+=1,$(a.li_number_product).children(".number").text(a.number_product))}},fiche_product:function(e){var t;return t=new XMLHttpRequest,t.open("GET","/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/get_one_product/"+e.id),t.send(null),t.onreadystatechange=function(){var e;if(t.readyState===t.DONE)return e=t.responseText,console.log("verif si ul"),console.log(a.ul_listing_produit.length),a.ul_listing_produit.length===0&&(a.div_sous_content.children(".other_products").html($(document.createElement("ul"))),a.ul_listing_produit=a.div_sous_content.children(".other_products").children("ul")),a.ul_listing_produit.prepend(e),a.ul_listing_produit.first().find(".close_square").on("click",function(){var e,t;return t=$(this).parents(".content").parents("div").parents("li"),e=$(this).attr("id").replace("produit_panier_",""),a.supp_product_basket(e,t)}),a.animate_for_tab(1e3)}},modify_card:function(){return $(a.li_number_product).children(".number").text(a.number_product)},supp_product_basket:function(e,t){var n;return n=new XMLHttpRequest,n.open("DELETE","/administration/users/"+$(".user_id").val()+"/paniers/"+a.panier_id+"/produit_paniers/"+e),n.setRequestHeader("Accept","application/json"),n.send(null),n.onreadystatechange=function(){var e;if(n.readyState===n.DONE)return e=JSON.parse(n.responseText),e.status==="error"?window.message_information.message_error(".lightbox_wrapper .header","erreur","Produit non supprimé",5e3):(a.number_product-=1,$(".header-list>p  ").text(a.number_product+" produits dans le panier"),t.children("div").animate({left:"500px"},{duration:500,complete:function(){return t.remove(),a.modify_card()}}))}}},$(".h1_listing_panier").length>0&&a.init(),$(".user_profile .content>.title").form_plugin({url_get_infos:["user"],champ:"prenom, nom",titre:"Modifier son identité",element:{type:"input"},button:{"class":"update_prenom",text_update:"Modifier"}}),$.ajax({type:"GET",url:"/villes/index",format:"json",complete:function(e){var t,n,r,i,s,o;r=$.parseJSON(e.responseText),n=[],s=[],o=r.ville;for(t in o)i=o[t],n.push(i.id),s.push(i.cp+" - "+i.nom);return $(".user_profile .content>.city").form_plugin({url_get_infos:["user"],champ:"ville_id",titre:"La ville",element:{type:"select",options:{value:n,text:s}},button:{"class":"update_ville",text_update:"Modifier la ville"}}).bind("end_form_plugin",function(){})}}),$(".user_profile .content>.description").form_plugin({url_get_infos:["user"],champ:"description",titre:"La description",element:{type:"textarea"},button:{"class":"update_description",text_update:"Modifier la description"}}),$(".user_profile .content>.address").form_plugin({url_get_infos:["user"],champ:"adresse",titre:"L'adresse",element:{type:"input"},button:{"class":"update_adresse",text_update:"Modifier l'adresse"}}),$(".user_profile .content>.phone").form_plugin({url_get_infos:["user"],champ:"telephone",titre:"Le telephone",element:{type:"input"},button:{"class":"update_telephone",text_update:"Modifier le telephone"}}),$(".user_profile .content>.email").form_plugin({url_get_infos:["user"],champ:"email",titre:"L'email",element:{type:"input"},button:{"class":"update_email",text_update:"Modifier l'email"}}),u={init:function(){return $(".card h2.title").form_plugin({champ:"titre",titre:"Le titre",element:{type:"input"},button:{"class":"update_titre",text_update:"Modifier le titre"},url_get_infos:["user","stock"],url_to_update:["user","stock"]}),$(".card p.description").form_plugin({url_get_infos:["user","stock"],champ:"description",titre:"La description",element:{type:"textarea"},button:{"class":"update_description",text_update:"Modifier la description"}}),$(".card li.prix").form_plugin({url_get_infos:["user","stock"],url_to_update:["user","produit_vente_libre"],champ:"prix_unite_ttc",titre:"Le prix",element:{type:"input"},button:{"class":"update_prix",text_update:"Modifier le prix"}}).bind("end_form_plugin",function(){return $(this).append(" €")}),$.ajax({type:"POST",url:"/administration/users/"+$("input.user_id").val()+"/get_unite_mesure",format:"json",complete:function(e){var t,n,r,i,s;r=$.parseJSON(e.responseText),n=[],s=[];for(t in r)i=r[t],n.push(i.id),s.push(i.nom);return $(".card li.unite_mesure").form_plugin({url_get_infos:["user","stock"],champ:"unite_mesure_id",titre:"L'unite de mesure",element:{type:"select",options:{value:n,text:s}},button:{"class":"update_unite_mesure",text_update:"Modifier l'unite de mesure"}}).bind("end_form_plugin",function(){return $(".info_unite_mesure_id").text("("+$(this).children("span.value").text()+")")})}}),$(".card li.quantite_lot").form_plugin({url_get_infos:["user","stock"],url_to_update:["user","produit_vente_libre"],titre:"Quantite d'un lot",champ:"quantite",element:{type:"input"},button:{"class":"update_quantite",text_update:"Modifier la quantite"}}).bind("end_form_plugin",function(){var e,t,n,r,i;return i=$("input.user_id").val(),e=$(this).parents("div").prevAll("div.informations_card").children("input.id_stock").val(),r="/administration/users/"+i+"/stocks/"+e,t=$(this).parents("ul").children("li.nombre_pack").children("span.value"),n=this,$.ajax({type:"GET",url:r,format:"json",success:function(e){var r;return t.text(e.produit_vente_libre.nombre_pack+" / "+e.produit_vente_libre.lot_possible_max+" ( possible )"),r=$(document.createElement("span")),r.addClass("is_italic info_unite_mesure_id"),r.text(" ("+e.unite_mesure.nom+")"),$(n).append(r)}})}),$(".card li.nombre_pack").form_plugin({url_get_infos:["user","stock"],url_to_update:["user","produit_vente_libre"],titre:"Nombre de lot",champ:"nombre_pack",element:{type:"input"},button:{"class":"update_nombre_pack",text_update:"Modifier le nombre de lot"}}).bind("end_form_plugin",function(){var e,t,n,r;return r=$("input.user_id").val(),e=$(this).parents("div").prevAll("div.informations_card").children("input.id_stock").val(),n="/administration/users/"+r+"/stocks/"+e,t=this,$.ajax({type:"GET",url:n,format:"json",success:function(e){return $(t).children("span.value").append(" /"+e.produit_vente_libre.lot_possible_max+" ( possible )")}})}),$(".card li.stock_total").form_plugin({url_get_infos:["user","stock"],champ:"quantite",titre:"Le stock total",element:{type:"input"},button:{"class":"update_quantite_stock",text_update:"Modifier le stock total"}}).bind("end_form_plugin",function(){var e,t,n,r,i;return i=$("input.user_id").val(),e=$(this).parents("div").prevAll("div.informations_card").children("input.id_stock").val(),r="/administration/users/"+i+"/stocks/"+e,t=$(this).parents("ul").children("li.nombre_pack").children("span.value"),n=this,$.ajax({type:"GET",url:r,format:"json",success:function(e){var r;return t.text(e.produit_vente_libre.nombre_pack+" / "+e.produit_vente_libre.lot_possible_max+"( possible )"),r=$(document.createElement("span")),r.addClass("is_italic info_unite_mesure_id"),r.text(" ("+e.unite_mesure.nom+")"),$(n).append(r)}})})},init_one_card:function(e){return $(e).find("h2.title").form_plugin({champ:"titre",titre:"Le titre",element:{type:"input"},button:{"class":"update_titre",text_update:"Modifier le titre"},url_get_infos:["user","stock"],url_to_update:["user","stock"]}),$(e).find("p.description").form_plugin({url_get_infos:["user","stock"],champ:"description",titre:"La description",element:{type:"textarea"},button:{"class":"update_description",text_update:"Modifier la description"}}),$(e).find("li.prix").form_plugin({url_get_infos:["user","stock"],url_to_update:["user","produit_vente_libre"],champ:"prix_unite_ttc",titre:"Le prix",element:{type:"input"},button:{"class":"update_prix",text_update:"Modifier le prix"}}).bind("end_form_plugin",function(){return $(this).append(" €")}),$.ajax({type:"POST",url:"/administration/users/"+$("input.user_id").val()+"/get_unite_mesure",format:"json",complete:function(t){var n,r,i,s,o;i=$.parseJSON(t.responseText),r=[],o=[];for(n in i)s=i[n],r.push(s.id),o.push(s.nom);return $(e).find("li.unite_mesure").form_plugin({url_get_infos:["user","stock"],champ:"unite_mesure_id",titre:"L'unite de mesure",element:{type:"select",options:{value:r,text:o}},button:{"class":"update_unite_mesure",text_update:"Modifier l'unite de mesure"}}).bind("end_form_plugin",function(){return $(".info_unite_mesure_id").text("("+$(this).children("span.value").text()+")")})}}),$(e).find("li.quantite_lot").form_plugin({url_get_infos:["user","stock"],url_to_update:["user","produit_vente_libre"],titre:"Quantite d'un lot",champ:"quantite",element:{type:"input"},button:{"class":"update_quantite",text_update:"Modifier la quantite"}}).bind("end_form_plugin",function(){var e,t,n,r,i;return i=$("input.user_id").val(),e=$(this).parents("div").prevAll("div.informations_card").children("input.id_stock").val(),r="/administration/users/"+i+"/stocks/"+e,t=$(this).parents("ul").children("li.nombre_pack").children("span.value"),n=this,$.ajax({type:"GET",url:r,format:"json",success:function(e){var r;return t.text(e.produit_vente_libre.nombre_pack+" / "+e.produit_vente_libre.lot_possible_max+" ( possible )"),r=$(document.createElement("span")),r.addClass("is_italic info_unite_mesure_id"),r.text(" ("+e.unite_mesure.nom+")"),$(n).append(r)}})}),$(e).find("li.nombre_pack").form_plugin({url_get_infos:["user","stock"],url_to_update:["user","produit_vente_libre"],titre:"Nombre de lot",champ:"nombre_pack",element:{type:"input"},button:{"class":"update_nombre_pack",text_update:"Modifier le nombre de lot"}}).bind("end_form_plugin",function(){var e,t,n,r;return r=$("input.user_id").val(),e=$(this).parents("div").prevAll("div.informations_card").children("input.id_stock").val(),n="/administration/users/"+r+"/stocks/"+e,t=this,$.ajax({type:"GET",url:n,format:"json",success:function(e){return $(t).children("span.value").append(" /"+e.produit_vente_libre.lot_possible_max+" ( possible )")}})}),$(e).find("li.stock_total").form_plugin({url_get_infos:["user","stock"],champ:"quantite",titre:"Le stock total",element:{type:"input"},button:{"class":"update_quantite_stock",text_update:"Modifier le stock total"}}).bind("end_form_plugin",function(){var e,t,n,r,i;return i=$("input.user_id").val(),e=$(this).parents("div").prevAll("div.informations_card").children("input.id_stock").val(),r="/administration/users/"+i+"/stocks/"+e,t=$(this).parents("ul").children("li.nombre_pack").children("span.value"),n=this,$.ajax({type:"GET",url:r,format:"json",success:function(e){var r;return t.text(e.produit_vente_libre.nombre_pack+" / "+e.produit_vente_libre.lot_possible_max+"( possible )"),r=$(document.createElement("span")),r.addClass("is_italic info_unite_mesure_id"),r.text(" ("+e.unite_mesure.nom+")"),$(n).append(r)}})})}},u.init(),c={hover_action:function(){return $(".subnav").each(function(){if(!$(this).hasClass("subnav_isopen"))return $(this).css({"margin-top":"-105px",position:"relative",opacity:0,"z-index":1})}),$(".pannels>li").css({position:"relative","z-index":2}),$("li.stock").bind("click",function(){return $(".subnav").hasClass("subnav_isopen")?($(".subnav").animate({marginTop:"-105px",opacity:0},1e3),$(".subnav").removeClass("subnav_isopen")):($(".subnav").animate({marginTop:"0px",opacity:1},1e3),$(".subnav").addClass("subnav_isopen"))})}},c.hover_action()})}).call(this);