(function(){$(document).ready(function(){return window.FormulaireSinscrire=function(){function e(e,t,n){this.id_form=e,this.id_button_submit=t,this.info_by_lightbox=n!=null?n:!0,this.erreur=!1,this.ajax_formulaire(),this.event_form()}return e.prototype.ajax_formulaire=function(){return $(this.id_form).bind("ajax:success",function(e,t){console.log("sinscrire"),console.log(t),lightbox_inscription.link_top(t),lightbox_inscription.hide();if(this.info_by_lightbox)return light_box_information.title_header("Success"),light_box_information.title_content("Connexion reussi"),light_box_information.text_content("Bonjour "+t.user.prenom),light_box_information.show(".lightbox_information")}),$(this.id_form).bind("ajax:error",function(e,t){return console.log(e),console.log(t),console.log("test-erreur-sinscrire")})},e.prototype.extract_error=function(e,t){var n,r;for(n in e)r=e[n],typeof r!="array"&&(t+="<br/><strong> "+n+"</strong> "+r);return t},e.prototype.event_form=function(){var e;return e=this,$(this.id_button_submit).bind("click",function(){e.verif_all_valid();if(e.erreur===!1)return console.log("tout est ok"),$(e.id_form).submit()}),$(this.id_form+" input#client_password_confirmation").bind("keyup",function(){return e.password_different()}),$(this.id_form+" input#client_email").bind("change",function(){return e.email_existant()}),$(this.id_form+" input").bind("change",function(){return e.input_is_empty("#"+$(this).attr("id"))})},e.prototype.verif_all_valid=function(){return this.erreur=!1,this.verif_all_input()&&(alert("Certain champ sont vide"),this.erreur=!0),this.password_different()&&(this.erreur=!0),this.email_existant()},e.prototype.email_existant=function(){var e;return e=this,this.erreur=!1,$.ajax({type:"POST",async:!1,url:"/clients/emailExist",data:{email:$(this.id_form+" input#client_email").val()},success:function(t){var n;return n="",t.exist===!0&&(n+="existe deja"),t.good_format===!1&&(n+="ce n'est pas une adresse mail."),n!==""?(div_state.div_error($(e.id_form+" #client_email"),n),e.erreur=!0,console.log(e.id_form)):div_state.div_success($(e.id_form+" #client_email"),n)}}),this.erreur},e.prototype.password_different=function(){var e,t;return e=$(this.id_form+" input#client_password").val(),t=$(this.id_form+" input#client_password_confirmation").val(),e===t?e===""?(div_state.div_warning($(this.id_form+" #client_password"),"Mot de passe vide"),!0):e.length<6?(div_state.div_warning($(this.id_form+" #client_password"),"Mot de passe trop court (plus de 6 caractere)"),!0):(div_state.div_success($(this.id_form+" #client_password"),"Mot de passe identique"),!1):(div_state.div_warning($(this.id_form+" #client_password"),"Mot de passe different"),!0)},e.prototype.verif_all_input=function(){var e;return e=!1,$(this.id_form+" input").each(function(){if($(this).val()==="")return $(this).css("border","1px solid red"),e=!0,console.log("1")}),e},e.prototype.input_is_empty=function(e){return $(e).val()===""?($(e).css("border","1px solid red"),!0):($(e).css("border","1px solid #CCCCCC"),!1)},e.prototype.show=function(){return $(this.id_form).css("display","block")},e.prototype.hide=function(){return $(this.id_form).css("display","none")},e}()})}).call(this);