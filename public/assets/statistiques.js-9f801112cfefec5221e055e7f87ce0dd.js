// Generated by CoffeeScript 1.2.1-pre
(function(){$(document).ready(function(){var e;return e={user_id:$("#id_user_stats").val(),init:function(){return $(".page-header").tooltip({trigger:"hover",placement:"left"}),e.data_month(),e.data_year()},data_month:function(){return $.ajax({type:"POST",url:"/administration/users/"+e.user_id+"/ca_by_month",async:!1,format:"json",success:function(t){var n,r;return r=t,n=[r.CA_product_ttc,r.CA_abonnement_ttc],e.create_pie(n)}})},data_year:function(){return $.ajax({type:"POST",url:"/administration/users/"+e.user_id+"/ca_by_year",async:!1,format:"json",success:function(t){var n,r,i,s;r=t,i=1,n=[];while(i<=12)i<10?s="0"+i:s=i,n.push({q:"2012-"+s,a:r.CA_increment[i].CA_product_ttc,b:r.CA_increment[i].CA_abonnement_ttc}),i++;return e.create_graph(n)}})},create_pie:function(e){var t,n;return n=Raphael("camembert"),t=n.piechart(320,240,100,e,{legend:["%%.%% - "+e[0]+" €","%%.%% - "+e[1]+" €"],legendpos:"est",colors:["#59a494","#ea9d6e"]}),$("#camembert path").css("box-shadow","1px 1px 1px solid black"),n.text(320,100,"Chiffre d'affaire du mois").attr({font:"20px sans-serif"}),t.hover(function(){this.sector.stop(),this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label)return this.label[0].stop(),this.label[0].attr({r:7.5}),this.label[1].attr({"font-weight":800})},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label)return this.label[0].animate({r:5},500,"bounce"),this.label[1].attr({"font-weight":400})})},create_graph:function(e){return console.log(e),Morris.Line({element:"graph",data:e,xkey:"q",ykeys:["a","b"],labels:["CA produit","CA abonnement"],lineColors:["#59a494","#ea9d6e"],lineWidth:2,smooth:!1,pointSize:3,hideHover:!0,xLabels:"month",xLabelFormat:function(e){switch(e.getMonth()){case 0:return"Jan.";case 1:return"Fév.";case 2:return"Ma.";case 3:return"Av.";case 4:return"Mai";case 5:return"Juin";case 6:return"Juil.";case 7:return"Aout";case 8:return"Sep.";case 9:return"Oct.";case 10:return"Nov.";case 11:return"Déc."}}})}},e.init()})}).call(this);